window.jsgv_zh_cn={locale:"zh_cn",whose_turn:"下一手",jump_to:"跳到第",jump_to_xx:"跳到第XX手",move_number_before:"",move_number_after:"",resign:"认输",black_dead:"黑被提",white_dead:"白被提",open_in_new_window:"在新窗口打开",refresh:"刷新棋谱内容",show_hide_move_number:"显示/隐藏手数",home:"到棋局开始",prev_comment_or_branch:"上一评论或变化图",fast_back:"快退",back:"上一手",forward:"下一手",fast_forward:"快进",next_comment_or_branch:"下一评论或变化图",end:"到棋局结束",submit:"执行",cancel:"取消",time:"时间",place:"地点",play_first:"先行",b:"黑",black:"黑方",w:"白",white:"白方",handicap:"让子",rule:"规则",komi:"贴目/子",moves:"手数",result:"结果",comment:"评论",comment_for:"第 MOVE 手评论",branch:"变化",branch_1:"变化一",branch_2:"变化二",branch_3:"变化三",branch_4:"变化四",branch_5:"变化五",branch_6:"变化六",branch_7:"变化七",branch_8:"变化八",branch_9:"变化九",trunk:"实战",branch_tag:"<变化>",error_thrown:"操作错误",confirm_resign:"你确定要认输吗？"};if(window.jsgvTranslations==undefined){window.jsgvTranslations=jsgv_zh_cn}window.jsgv_en_us={locale:"en_us",whose_turn:"Next",jump_to:"Jump to",jump_to_xx:"Jump to XX",move_number_before:"",move_number_after:"",resign:"Resign",black_dead:"B dead",white_dead:"W dead",open_in_new_window:"Open in new window",refresh:"Refresh game/board",show_hide_move_number:"Show/hide move number",home:"Back to beginning",prev_comment_or_branch:"Previous comment or variation",fast_back:"Fast back",back:"Back",forward:"Forward",fast_forward:"Fast forward",next_comment_or_branch:"Next comment or variation",end:"Forward to end",submit:"OK",cancel:"Cancel",time:"Time",place:"Place",play_first:"Play first",b:"B",black:"Black",w:"W",white:"White",handicap:"Handicap",rule:"Rule",komi:"Komi",moves:"Moves",result:"Result",comment:"Comment",comment_for:"Comment for MOVE",branch:"Variation",branch_1:"Variation 1",branch_2:"Variation 2",branch_3:"Variation 3",branch_4:"Variation 4",branch_5:"Variation 5",branch_6:"Variation 6",branch_7:"Variation 7",branch_8:"Variation 8",branch_9:"Variation 9",trunk:"Game move",branch_tag:"<Variation>",error_thrown:"Error",confirm_resign:"Are you sure you want to resign?"};if(window.jsgvTranslations==undefined){window.jsgvTranslations=jsgv_en_us}(function(){var W=this,ab,F=W.jQuery,S=W.$,T=W.jQuery=W.$=function(d,b){return new T.fn.init(d,b)},M=/^[^<]*(<(.|\s)+>)[^>]*$|^#([\w-]+)$/,ac=/^.[^:#\[\.,]*$/;T.fn=T.prototype={init:function(g,d){g=g||document;if(g.nodeType){this[0]=g;this.length=1;this.context=g;return this}if(typeof g==="string"){var e=M.exec(g);if(e&&(e[1]||!d)){if(e[1]){g=T.clean([e[1]],d)}else{var b=document.getElementById(e[3]);if(b&&b.id!=e[3]){return T().find(g)}var f=T(b||[]);f.context=document;f.selector=g;return f}}else{return T(d).find(g)}}else{if(T.isFunction(g)){return T(document).ready(g)}}if(g.selector&&g.context){this.selector=g.selector;this.context=g.context}return this.setArray(T.isArray(g)?g:T.makeArray(g))},selector:"",jquery:"1.3.2",size:function(){return this.length},get:function(b){return b===ab?Array.prototype.slice.call(this):this[b]},pushStack:function(e,b,f){var d=T(e);d.prevObject=this;d.context=this.context;if(b==="find"){d.selector=this.selector+(this.selector?" ":"")+f}else{if(b){d.selector=this.selector+"."+b+"("+f+")"}}return d},setArray:function(b){this.length=0;Array.prototype.push.apply(this,b);return this},each:function(b,d){return T.each(this,b,d)},index:function(b){return T.inArray(b&&b.jquery?b[0]:b,this)},attr:function(e,b,d){var f=e;if(typeof e==="string"){if(b===ab){return this[0]&&T[d||"attr"](this[0],e)}else{f={};f[e]=b}}return this.each(function(g){for(e in f){T.attr(d?this.style:this,e,T.prop(this,f[e],d,g,e))}})},css:function(d,b){if((d=="width"||d=="height")&&parseFloat(b)<0){b=ab}return this.attr(d,b,"curCSS")},text:function(b){if(typeof b!=="object"&&b!=null){return this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(b))}var d="";T.each(b||this,function(){T.each(this.childNodes,function(){if(this.nodeType!=8){d+=this.nodeType!=1?this.nodeValue:T.fn.text([this])}})});return d},wrapAll:function(d){if(this[0]){var b=T(d,this[0].ownerDocument).clone();if(this[0].parentNode){b.insertBefore(this[0])}b.map(function(){var e=this;while(e.firstChild){e=e.firstChild}return e}).append(this)}return this},wrapInner:function(b){return this.each(function(){T(this).contents().wrapAll(b)})},wrap:function(b){return this.each(function(){T(this).wrapAll(b)})},append:function(){return this.domManip(arguments,true,function(b){if(this.nodeType==1){this.appendChild(b)}})},prepend:function(){return this.domManip(arguments,true,function(b){if(this.nodeType==1){this.insertBefore(b,this.firstChild)}})},before:function(){return this.domManip(arguments,false,function(b){this.parentNode.insertBefore(b,this)})},after:function(){return this.domManip(arguments,false,function(b){this.parentNode.insertBefore(b,this.nextSibling)})},end:function(){return this.prevObject||T([])},push:[].push,sort:[].sort,splice:[].splice,find:function(d){if(this.length===1){var b=this.pushStack([],"find",d);b.length=0;T.find(d,this[0],b);return b}else{return this.pushStack(T.unique(T.map(this,function(e){return T.find(d,e)})),"find",d)}},clone:function(d){var f=this.map(function(){if(!T.support.noCloneEvent&&!T.isXMLDoc(this)){var h=this.outerHTML;if(!h){var g=this.ownerDocument.createElement("div");g.appendChild(this.cloneNode(true));h=g.innerHTML}return T.clean([h.replace(/ jQuery\d+="(?:\d+|null)"/g,"").replace(/^\s*/,"")])[0]}else{return this.cloneNode(true)}});if(d===true){var b=this.find("*").andSelf(),e=0;f.find("*").andSelf().each(function(){if(this.nodeName!==b[e].nodeName){return}var i=T.data(b[e],"events");for(var g in i){for(var h in i[g]){T.event.add(this,g,i[g][h],i[g][h].data)}}e++})}return f},filter:function(b){return this.pushStack(T.isFunction(b)&&T.grep(this,function(d,e){return b.call(d,e)})||T.multiFilter(b,T.grep(this,function(d){return d.nodeType===1})),"filter",b)},closest:function(e){var b=T.expr.match.POS.test(e)?T(e):null,d=0;return this.map(function(){var f=this;while(f&&f.ownerDocument){if(b?b.index(f)>-1:T(f).is(e)){T.data(f,"closest",d);return f}f=f.parentNode;d++}})},not:function(d){if(typeof d==="string"){if(ac.test(d)){return this.pushStack(T.multiFilter(d,this,true),"not",d)}else{d=T.multiFilter(d,this)}}var b=d.length&&d[d.length-1]!==ab&&!d.nodeType;return this.filter(function(){return b?T.inArray(this,d)<0:this!=d})},add:function(b){return this.pushStack(T.unique(T.merge(this.get(),typeof b==="string"?T(b):T.makeArray(b))))},is:function(b){return !!b&&T.multiFilter(b,this).length>0},hasClass:function(b){return !!b&&this.is("."+b)},val:function(e){if(e===ab){var l=this[0];if(l){if(T.nodeName(l,"option")){return(l.attributes.value||{}).specified?l.value:l.text}if(T.nodeName(l,"select")){var g=l.selectedIndex,d=[],b=l.options,h=l.type=="select-one";if(g<0){return null}for(var k=h?g:0,f=h?g+1:b.length;k<f;k++){var i=b[k];if(i.selected){e=T(i).val();if(h){return e}d.push(e)}}return d}return(l.value||"").replace(/\r/g,"")}return ab}if(typeof e==="number"){e+=""}return this.each(function(){if(this.nodeType!=1){return}if(T.isArray(e)&&/radio|checkbox/.test(this.type)){this.checked=(T.inArray(this.value,e)>=0||T.inArray(this.name,e)>=0)}else{if(T.nodeName(this,"select")){var m=T.makeArray(e);T("option",this).each(function(){this.selected=(T.inArray(this.value,m)>=0||T.inArray(this.text,m)>=0)});if(!m.length){this.selectedIndex=-1}}else{this.value=e}}})},html:function(b){return b===ab?(this[0]?this[0].innerHTML.replace(/ jQuery\d+="(?:\d+|null)"/g,""):null):this.empty().append(b)},replaceWith:function(b){return this.after(b).remove()},eq:function(b){return this.slice(b,+b+1)},slice:function(){return this.pushStack(Array.prototype.slice.apply(this,arguments),"slice",Array.prototype.slice.call(arguments).join(","))},map:function(b){return this.pushStack(T.map(this,function(d,e){return b.call(d,e,d)}))},andSelf:function(){return this.add(this.prevObject)},domManip:function(f,b,d){if(this[0]){var g=(this[0].ownerDocument||this[0]).createDocumentFragment(),k=T.clean(f,(this[0].ownerDocument||this[0]),g),h=g.firstChild;if(h){for(var i=0,l=this.length;i<l;i++){d.call(e(this[i],h),this.length>1||i>0?g.cloneNode(true):g)}}if(k){T.each(k,E)}}return this;function e(n,m){return b&&T.nodeName(n,"table")&&T.nodeName(m,"tr")?(n.getElementsByTagName("tbody")[0]||n.appendChild(n.ownerDocument.createElement("tbody"))):n}}};T.fn.init.prototype=T.fn;function E(d,b){if(b.src){T.ajax({url:b.src,async:false,dataType:"script"})}else{T.globalEval(b.text||b.textContent||b.innerHTML||"")}if(b.parentNode){b.parentNode.removeChild(b)}}function ad(){return +new Date}T.extend=T.fn.extend=function(){var e=arguments[0]||{},g=1,f=arguments.length,k=false,h;if(typeof e==="boolean"){k=e;e=arguments[1]||{};g=2}if(typeof e!=="object"&&!T.isFunction(e)){e={}}if(f==g){e=this;--g}for(;g<f;g++){if((h=arguments[g])!=null){for(var i in h){var d=e[i],b=h[i];if(e===b){continue}if(k&&b&&typeof b==="object"&&!b.nodeType){e[i]=T.extend(k,d||(b.length!=null?[]:{}),b)}else{if(b!==ab){e[i]=b}}}}}return e};var ag=/z-?index|font-?weight|opacity|zoom|line-?height/i,Q=document.defaultView||{},L=Object.prototype.toString;T.extend({noConflict:function(b){W.$=S;if(b){W.jQuery=F}return T},isFunction:function(b){return L.call(b)==="[object Function]"},isArray:function(b){return L.call(b)==="[object Array]"},isXMLDoc:function(b){return b.nodeType===9&&b.documentElement.nodeName!=="HTML"||!!b.ownerDocument&&T.isXMLDoc(b.ownerDocument)},globalEval:function(b){if(b&&/\S/.test(b)){var d=document.getElementsByTagName("head")[0]||document.documentElement,e=document.createElement("script");e.type="text/javascript";if(T.support.scriptEval){e.appendChild(document.createTextNode(b))}else{e.text=b}d.insertBefore(e,d.firstChild);d.removeChild(e)}},nodeName:function(b,d){return b.nodeName&&b.nodeName.toUpperCase()==d.toUpperCase()},each:function(g,b,h){var i,f=0,e=g.length;if(h){if(e===ab){for(i in g){if(b.apply(g[i],h)===false){break}}}else{for(;f<e;){if(b.apply(g[f++],h)===false){break}}}}else{if(e===ab){for(i in g){if(b.call(g[i],i,g[i])===false){break}}}else{for(var d=g[0];f<e&&b.call(d,f,d)!==false;d=g[++f]){}}}return g},prop:function(d,b,e,f,g){if(T.isFunction(b)){b=b.call(d,f)}return typeof b==="number"&&e=="curCSS"&&!ag.test(g)?b+"px":b},className:{add:function(d,b){T.each((b||"").split(/\s+/),function(f,e){if(d.nodeType==1&&!T.className.has(d.className,e)){d.className+=(d.className?" ":"")+e}})},remove:function(d,b){if(d.nodeType==1){d.className=b!==ab?T.grep(d.className.split(/\s+/),function(e){return !T.className.has(b,e)}).join(" "):""}},has:function(b,d){return b&&T.inArray(d,(b.className||b).toString().split(/\s+/))>-1}},swap:function(d,e,b){var g={};for(var f in e){g[f]=d.style[f];d.style[f]=e[f]}b.call(d);for(var f in e){d.style[f]=g[f]}},css:function(g,i,e,k){if(i=="width"||i=="height"){var b,h={position:"absolute",visibility:"hidden",display:"block"},d=i=="width"?["Left","Right"]:["Top","Bottom"];function f(){b=i=="width"?g.offsetWidth:g.offsetHeight;if(k==="border"){return}T.each(d,function(){if(!k){b-=parseFloat(T.curCSS(g,"padding"+this,true))||0}if(k==="margin"){b+=parseFloat(T.curCSS(g,"margin"+this,true))||0}else{b-=parseFloat(T.curCSS(g,"border"+this+"Width",true))||0}})}if(g.offsetWidth!==0){f()}else{T.swap(g,h,f)}return Math.max(0,Math.round(b))}return T.curCSS(g,i,e)},curCSS:function(g,k,i){var d,l=g.style;if(k=="opacity"&&!T.support.opacity){d=T.attr(l,"opacity");return d==""?"1":d}if(k.match(/float/i)){k=H}if(!i&&l&&l[k]){d=l[k]}else{if(Q.getComputedStyle){if(k.match(/float/i)){k="float"}k=k.replace(/([A-Z])/g,"-$1").toLowerCase();var b=Q.getComputedStyle(g,null);if(b){d=b.getPropertyValue(k)}if(k=="opacity"&&d==""){d="1"}}else{if(g.currentStyle){var f=k.replace(/\-(\w)/g,function(n,m){return m.toUpperCase()});d=g.currentStyle[k]||g.currentStyle[f];if(!/^\d+(px)?$/i.test(d)&&/^\d/.test(d)){var h=l.left,e=g.runtimeStyle.left;g.runtimeStyle.left=g.currentStyle.left;l.left=d||0;d=l.pixelLeft+"px";l.left=h;g.runtimeStyle.left=e}}}}return d},clean:function(i,d,f){d=d||document;if(typeof d.createElement==="undefined"){d=d.ownerDocument||d[0]&&d[0].ownerDocument||document}if(!f&&i.length===1&&typeof i[0]==="string"){var g=/^<(\w+)\s*\/?>$/.exec(i[0]);if(g){return[d.createElement(g[1])]}}var h=[],k=[],b=d.createElement("div");T.each(i,function(o,l){if(typeof l==="number"){l+=""}if(!l){return}if(typeof l==="string"){l=l.replace(/(<(\w+)[^>]*?)\/>/g,function(t,s,u){return u.match(/^(abbr|br|col|img|input|link|meta|param|hr|area|embed)$/i)?t:s+"></"+u+">"});var p=l.replace(/^\s+/,"").substring(0,10).toLowerCase();var n=!p.indexOf("<opt")&&[1,"<select multiple='multiple'>","</select>"]||!p.indexOf("<leg")&&[1,"<fieldset>","</fieldset>"]||p.match(/^<(thead|tbody|tfoot|colg|cap)/)&&[1,"<table>","</table>"]||!p.indexOf("<tr")&&[2,"<table><tbody>","</tbody></table>"]||(!p.indexOf("<td")||!p.indexOf("<th"))&&[3,"<table><tbody><tr>","</tr></tbody></table>"]||!p.indexOf("<col")&&[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"]||!T.support.htmlSerialize&&[1,"div<div>","</div>"]||[0,"",""];b.innerHTML=n[1]+l+n[2];while(n[0]--){b=b.lastChild}if(!T.support.tbody){var m=/<tbody/i.test(l),q=!p.indexOf("<table")&&!m?b.firstChild&&b.firstChild.childNodes:n[1]=="<table>"&&!m?b.childNodes:[];for(var r=q.length-1;r>=0;--r){if(T.nodeName(q[r],"tbody")&&!q[r].childNodes.length){q[r].parentNode.removeChild(q[r])}}}if(!T.support.leadingWhitespace&&/^\s/.test(l)){b.insertBefore(d.createTextNode(l.match(/^\s*/)[0]),b.firstChild)}l=T.makeArray(b.childNodes)}if(l.nodeType){h.push(l)}else{h=T.merge(h,l)}});if(f){for(var e=0;h[e];e++){if(T.nodeName(h[e],"script")&&(!h[e].type||h[e].type.toLowerCase()==="text/javascript")){k.push(h[e].parentNode?h[e].parentNode.removeChild(h[e]):h[e])}else{if(h[e].nodeType===1){h.splice.apply(h,[e+1,0].concat(T.makeArray(h[e].getElementsByTagName("script"))))}f.appendChild(h[e])}}return k}return h},attr:function(e,h,d){if(!e||e.nodeType==3||e.nodeType==8){return ab}var g=!T.isXMLDoc(e),b=d!==ab;h=g&&T.props[h]||h;if(e.tagName){var i=/href|src|style/.test(h);if(h=="selected"&&e.parentNode){e.parentNode.selectedIndex}if(h in e&&g&&!i){if(b){if(h=="type"&&T.nodeName(e,"input")&&e.parentNode){throw"type property can't be changed"}e[h]=d}if(T.nodeName(e,"form")&&e.getAttributeNode(h)){return e.getAttributeNode(h).nodeValue}if(h=="tabIndex"){var f=e.getAttributeNode("tabIndex");return f&&f.specified?f.value:e.nodeName.match(/(button|input|object|select|textarea)/i)?0:e.nodeName.match(/^(a|area)$/i)&&e.href?0:ab}return e[h]}if(!T.support.style&&g&&h=="style"){return T.attr(e.style,"cssText",d)}if(b){e.setAttribute(h,""+d)}var k=!T.support.hrefNormalized&&g&&i?e.getAttribute(h,2):e.getAttribute(h);return k===null?ab:k}if(!T.support.opacity&&h=="opacity"){if(b){e.zoom=1;e.filter=(e.filter||"").replace(/alpha\([^)]*\)/,"")+(parseInt(d)+""=="NaN"?"":"alpha(opacity="+d*100+")")}return e.filter&&e.filter.indexOf("opacity=")>=0?(parseFloat(e.filter.match(/opacity=([^)]*)/)[1])/100)+"":""}h=h.replace(/-([a-z])/ig,function(m,l){return l.toUpperCase()});if(b){e[h]=d}return e[h]},trim:function(b){return(b||"").replace(/^\s+|\s+$/g,"")},makeArray:function(b){var e=[];if(b!=null){var d=b.length;if(d==null||typeof b==="string"||T.isFunction(b)||b.setInterval){e[0]=b}else{while(d){e[--d]=b[d]}}}return e},inArray:function(d,b){for(var f=0,e=b.length;f<e;f++){if(b[f]===d){return f}}return -1},merge:function(d,g){var f=0,e,b=d.length;if(!T.support.getAll){while((e=g[f++])!=null){if(e.nodeType!=8){d[b++]=e}}}else{while((e=g[f++])!=null){d[b++]=e}}return d},unique:function(b){var h=[],i={};try{for(var g=0,f=b.length;g<f;g++){var d=T.data(b[g]);if(!i[d]){i[d]=true;h.push(b[g])}}}catch(e){h=b}return h},grep:function(g,b,h){var f=[];for(var e=0,d=g.length;e<d;e++){if(!h!=!b(g[e],e)){f.push(g[e])}}return f},map:function(h,b){var g=[];for(var f=0,e=h.length;f<e;f++){var d=b(h[f],f);if(d!=null){g[g.length]=d}}return g.concat.apply([],g)}});var O=navigator.userAgent.toLowerCase();T.browser={version:(O.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],safari:/webkit/.test(O),opera:/opera/.test(O),msie:/msie/.test(O)&&!/opera/.test(O),mozilla:/mozilla/.test(O)&&!/(compatible|webkit)/.test(O)};T.each({parent:function(b){return b.parentNode},parents:function(b){return T.dir(b,"parentNode")},next:function(b){return T.nth(b,2,"nextSibling")},prev:function(b){return T.nth(b,2,"previousSibling")},nextAll:function(b){return T.dir(b,"nextSibling")},prevAll:function(b){return T.dir(b,"previousSibling")},siblings:function(b){return T.sibling(b.parentNode.firstChild,b)},children:function(b){return T.sibling(b.firstChild)},contents:function(b){return T.nodeName(b,"iframe")?b.contentDocument||b.contentWindow.document:T.makeArray(b.childNodes)}},function(d,b){T.fn[d]=function(f){var e=T.map(this,b);if(f&&typeof f=="string"){e=T.multiFilter(f,e)}return this.pushStack(T.unique(e),d,f)}});T.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(d,b){T.fn[d]=function(k){var g=[],e=T(k);for(var f=0,i=e.length;f<i;f++){var h=(f>0?this.clone(true):this).get();T.fn[b].apply(T(e[f]),h);g=g.concat(h)}return this.pushStack(g,d,k)}});T.each({removeAttr:function(b){T.attr(this,b,"");if(this.nodeType==1){this.removeAttribute(b)}},addClass:function(b){T.className.add(this,b)},removeClass:function(b){T.className.remove(this,b)},toggleClass:function(b,d){if(typeof d!=="boolean"){d=!T.className.has(this,b)}T.className[d?"add":"remove"](this,b)},remove:function(b){if(!b||T.filter(b,[this]).length){T("*",this).add([this]).each(function(){T.event.remove(this);T.removeData(this)});if(this.parentNode){this.parentNode.removeChild(this)}}},empty:function(){T(this).children().remove();while(this.firstChild){this.removeChild(this.firstChild)}}},function(d,b){T.fn[d]=function(){return this.each(b,arguments)}});function Y(d,b){return d[0]&&parseInt(T.curCSS(d[0],b,true),10)||0}var aa="jQuery"+ad(),I=0,R={};T.extend({cache:{},data:function(e,f,d){e=e==W?R:e;var b=e[aa];if(!b){b=e[aa]=++I}if(f&&!T.cache[b]){T.cache[b]={}}if(d!==ab){T.cache[b][f]=d}return f?T.cache[b][f]:b},removeData:function(e,f){e=e==W?R:e;var b=e[aa];if(f){if(T.cache[b]){delete T.cache[b][f];f="";for(f in T.cache[b]){break}if(!f){T.removeData(e)}}}else{try{delete e[aa]}catch(d){if(e.removeAttribute){e.removeAttribute(aa)}}delete T.cache[b]}},queue:function(e,f,b){if(e){f=(f||"fx")+"queue";var d=T.data(e,f);if(!d||T.isArray(b)){d=T.data(e,f,T.makeArray(b))}else{if(b){d.push(b)}}}return d},dequeue:function(b,d){var f=T.queue(b,d),e=f.shift();if(!d||d==="fx"){e=f[0]}if(e!==ab){e.call(b)}}});T.fn.extend({data:function(f,d){var b=f.split(".");b[1]=b[1]?"."+b[1]:"";if(d===ab){var e=this.triggerHandler("getData"+b[1]+"!",[b[0]]);if(e===ab&&this.length){e=T.data(this[0],f)}return e===ab&&b[1]?this.data(b[0]):e}else{return this.trigger("setData"+b[1]+"!",[b[0],d]).each(function(){T.data(this,f,d)})}},removeData:function(b){return this.each(function(){T.removeData(this,b)})},queue:function(d,b){if(typeof d!=="string"){b=d;d="fx"}if(b===ab){return T.queue(this[0],d)}return this.each(function(){var e=T.queue(this,d,b);if(d=="fx"&&e.length==1){e[0].call(this)}})},dequeue:function(b){return this.each(function(){T.dequeue(this,b)})}});(function(){var d=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?/g,k=0,o=Object.prototype.toString;var q=function(u,y,al,ak){al=al||[];y=y||document;if(y.nodeType!==1&&y.nodeType!==9){return[]}if(!u||typeof u!=="string"){return al}var t=[],w,D,A,z,aj,x,v=true;d.lastIndex=0;while((w=d.exec(u))!==null){t.push(w[1]);if(w[2]){x=RegExp.rightContext;break}}if(t.length>1&&i.exec(u)){if(t.length===2&&n.relative[t[0]]){D=m(t[0]+t[1],y)}else{D=n.relative[t[0]]?[y]:q(t.shift(),y);while(t.length){u=t.shift();if(n.relative[u]){u+=t.shift()}D=m(u,D)}}}else{var ai=ak?{expr:t.pop(),set:r(ak)}:q.find(t.pop(),t.length===1&&y.parentNode?y.parentNode:y,e(y));D=q.filter(ai.expr,ai.set);if(t.length>0){A=r(D)}else{v=false}while(t.length){var B=t.pop(),C=B;if(!n.relative[B]){B=""}else{C=t.pop()}if(C==null){C=y}n.relative[B](A,C,e(y))}}if(!A){A=D}if(!A){throw"Syntax error, unrecognized expression: "+(B||u)}if(o.call(A)==="[object Array]"){if(!v){al.push.apply(al,A)}else{if(y.nodeType===1){for(var s=0;A[s]!=null;s++){if(A[s]&&(A[s]===true||A[s].nodeType===1&&l(y,A[s]))){al.push(D[s])}}}else{for(var s=0;A[s]!=null;s++){if(A[s]&&A[s].nodeType===1){al.push(D[s])}}}}}else{r(A,al)}if(x){q(x,y,al,ak);if(p){hasDuplicate=false;al.sort(p);if(hasDuplicate){for(var s=1;s<al.length;s++){if(al[s]===al[s-1]){al.splice(s--,1)}}}}}return al};q.matches=function(t,s){return q(t,null,null,s)};q.find=function(s,z,A){var t,v;if(!s){return[]}for(var w=0,x=n.order.length;w<x;w++){var u=n.order[w],v;if((v=n.match[u].exec(s))){var y=RegExp.leftContext;if(y.substr(y.length-1)!=="\\"){v[1]=(v[1]||"").replace(/\\/g,"");t=n.find[u](v,z,A);if(t!=null){s=s.replace(n.match[u],"");break}}}}if(!t){t=z.getElementsByTagName("*")}return{set:t,expr:s}};q.filter=function(aj,ak,C,w){var x=aj,A=[],s=ak,u,z,t=ak&&ak[0]&&e(ak[0]);while(aj&&ak.length){for(var al in n.filter){if((u=n.match[al].exec(aj))!=null){var y=n.filter[al],B,D;z=false;if(s==A){A=[]}if(n.preFilter[al]){u=n.preFilter[al](u,s,C,A,w,t);if(!u){z=B=true}else{if(u===true){continue}}}if(u){for(var v=0;(D=s[v])!=null;v++){if(D){B=y(D,u,v,s);var ai=w^!!B;if(C&&B!=null){if(ai){z=true}else{s[v]=false}}else{if(ai){A.push(D);z=true}}}}}if(B!==ab){if(!C){s=A}aj=aj.replace(n.match[al],"");if(!z){return[]}break}}}if(aj==x){if(z==null){throw"Syntax error, unrecognized expression: "+aj}else{break}}x=aj}return s};var n=q.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF_-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF_-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF_-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF_-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*_-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF_-]|\\.)+)(?:\((['"]*)((?:\([^\)]+\)|[^\2\(\)]*)+)\2\))?/},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(s){return s.getAttribute("href")}},relative:{"+":function(s,z,t){var v=typeof z==="string",A=v&&!/\W/.test(z),u=v&&!A;if(A&&!t){z=z.toUpperCase()}for(var w=0,x=s.length,y;w<x;w++){if((y=s[w])){while((y=y.previousSibling)&&y.nodeType!==1){}s[w]=u||y&&y.nodeName===z?y||false:y===z}}if(u){q.filter(z,s,true)}},">":function(x,u,w){var z=typeof u==="string";if(z&&!/\W/.test(u)){u=w?u:u.toUpperCase();for(var t=0,v=x.length;t<v;t++){var y=x[t];if(y){var s=y.parentNode;x[t]=s.nodeName===u?s:false}}}else{for(var t=0,v=x.length;t<v;t++){var y=x[t];if(y){x[t]=z?y.parentNode:y.parentNode===u}}if(z){q.filter(u,x,true)}}},"":function(s,u,w){var t=k++,v=b;if(!u.match(/\W/)){var x=u=w?u:u.toUpperCase();v=f}v("parentNode",u,t,s,x,w)},"~":function(s,u,w){var t=k++,v=b;if(typeof u==="string"&&!u.match(/\W/)){var x=u=w?u:u.toUpperCase();v=f}v("previousSibling",u,t,s,x,w)}},find:{ID:function(u,t,s){if(typeof t.getElementById!=="undefined"&&!s){var v=t.getElementById(u[1]);return v?[v]:[]}},NAME:function(t,x,w){if(typeof x.getElementsByName!=="undefined"){var u=[],y=x.getElementsByName(t[1]);for(var s=0,v=y.length;s<v;s++){if(y[s].getAttribute("name")===t[1]){u.push(y[s])}}return u.length===0?null:u}},TAG:function(t,s){return s.getElementsByTagName(t[1])}},preFilter:{CLASS:function(s,u,t,v,x,w){s=" "+s[1].replace(/\\/g,"")+" ";if(w){return s}for(var z=0,y;(y=u[z])!=null;z++){if(y){if(x^(y.className&&(" "+y.className+" ").indexOf(s)>=0)){if(!t){v.push(y)}}else{if(t){u[z]=false}}}}return false},ID:function(s){return s[1].replace(/\\/g,"")},TAG:function(t,u){for(var s=0;u[s]===false;s++){}return u[s]&&e(u[s])?t[1]:t[1].toUpperCase()},CHILD:function(t){if(t[1]=="nth"){var s=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(t[2]=="even"&&"2n"||t[2]=="odd"&&"2n+1"||!/\D/.test(t[2])&&"0n+"+t[2]||t[2]);t[2]=(s[1]+(s[2]||1))-0;t[3]=s[3]-0}t[0]=k++;return t},ATTR:function(y,u,t,v,x,w){var s=y[1].replace(/\\/g,"");if(!w&&n.attrMap[s]){y[1]=n.attrMap[s]}if(y[2]==="~="){y[4]=" "+y[4]+" "}return y},PSEUDO:function(x,u,t,v,w){if(x[1]==="not"){if(x[3].match(d).length>1||/^\w/.test(x[3])){x[3]=q(x[3],null,null,u)}else{var s=q.filter(x[3],u,t,true^w);if(!t){v.push.apply(v,s)}return false}}else{if(n.match.POS.test(x[0])||n.match.CHILD.test(x[0])){return true}}return x},POS:function(s){s.unshift(true);return s}},filters:{enabled:function(s){return s.disabled===false&&s.type!=="hidden"},disabled:function(s){return s.disabled===true},checked:function(s){return s.checked===true},selected:function(s){s.parentNode.selectedIndex;return s.selected===true},parent:function(s){return !!s.firstChild},empty:function(s){return !s.firstChild},has:function(s,t,u){return !!q(u[3],s).length},header:function(s){return/h\d/i.test(s.nodeName)},text:function(s){return"text"===s.type},radio:function(s){return"radio"===s.type},checkbox:function(s){return"checkbox"===s.type},file:function(s){return"file"===s.type},password:function(s){return"password"===s.type},submit:function(s){return"submit"===s.type},image:function(s){return"image"===s.type},reset:function(s){return"reset"===s.type},button:function(s){return"button"===s.type||s.nodeName.toUpperCase()==="BUTTON"},input:function(s){return/input|select|textarea|button/i.test(s.nodeName)}},setFilters:{first:function(s,t){return t===0},last:function(t,u,v,s){return u===s.length-1},even:function(s,t){return t%2===0},odd:function(s,t){return t%2===1},lt:function(s,t,u){return t<u[3]-0},gt:function(s,t,u){return t>u[3]-0},nth:function(s,t,u){return u[3]-0==t},eq:function(s,t,u){return u[3]-0==t}},filter:{PSEUDO:function(x,t,s,w){var u=t[1],z=n.filters[u];if(z){return z(x,s,t,w)}else{if(u==="contains"){return(x.textContent||x.innerText||"").indexOf(t[3])>=0}else{if(u==="not"){var y=t[3];for(var s=0,v=y.length;s<v;s++){if(y[s]===x){return false}}return true}}}},CHILD:function(z,w){var t=w[1],y=z;switch(t){case"only":case"first":while(y=y.previousSibling){if(y.nodeType===1){return false}}if(t=="first"){return true}y=z;case"last":while(y=y.nextSibling){if(y.nodeType===1){return false}}return true;case"nth":var x=w[2],A=w[3];if(x==1&&A==0){return true}var u=w[0],B=z.parentNode;if(B&&(B.sizcache!==u||!z.nodeIndex)){var v=0;for(y=B.firstChild;y;y=y.nextSibling){if(y.nodeType===1){y.nodeIndex=++v}}B.sizcache=u}var s=z.nodeIndex-A;if(x==0){return s==0}else{return(s%x==0&&s/x>=0)}}},ID:function(s,t){return s.nodeType===1&&s.getAttribute("id")===t},TAG:function(s,t){return(t==="*"&&s.nodeType===1)||s.nodeName===t},CLASS:function(s,t){return(" "+(s.className||s.getAttribute("class"))+" ").indexOf(t)>-1},ATTR:function(x,s){var t=s[1],v=n.attrHandle[t]?n.attrHandle[t](x):x[t]!=null?x[t]:x.getAttribute(t),w=v+"",y=s[2],u=s[4];return v==null?y==="!=":y==="="?w===u:y==="*="?w.indexOf(u)>=0:y==="~="?(" "+w+" ").indexOf(u)>=0:!u?w&&v!==false:y==="!="?w!=u:y==="^="?w.indexOf(u)===0:y==="$="?w.substr(w.length-u.length)===u:y==="|="?w===u||w.substr(0,u.length+1)===u+"-":false},POS:function(x,u,t,w){var v=u[2],s=n.setFilters[v];if(s){return s(x,t,u,w)}}}};var i=n.match.POS;for(var g in n.match){n.match[g]=RegExp(n.match[g].source+/(?![^\[]*\])(?![^\(]*\))/.source)}var r=function(s,t){s=Array.prototype.slice.call(s);if(t){t.push.apply(t,s);return t}return s};try{Array.prototype.slice.call(document.documentElement.childNodes)}catch(h){r=function(w,s){var u=s||[];if(o.call(w)==="[object Array]"){Array.prototype.push.apply(u,w)}else{if(typeof w.length==="number"){for(var t=0,v=w.length;t<v;t++){u.push(w[t])}}else{for(var t=0;w[t];t++){u.push(w[t])}}}return u}}var p;if(document.documentElement.compareDocumentPosition){p=function(t,u){var s=t.compareDocumentPosition(u)&4?-1:t===u?0:1;if(s===0){hasDuplicate=true}return s}}else{if("sourceIndex" in document.documentElement){p=function(t,u){var s=t.sourceIndex-u.sourceIndex;if(s===0){hasDuplicate=true}return s}}else{if(document.createRange){p=function(s,u){var t=s.ownerDocument.createRange(),v=u.ownerDocument.createRange();t.selectNode(s);t.collapse(true);v.selectNode(u);v.collapse(true);var w=t.compareBoundaryPoints(Range.START_TO_END,v);if(w===0){hasDuplicate=true}return w}}}}(function(){var t=document.createElement("form"),s="script"+(new Date).getTime();t.innerHTML="<input name='"+s+"'/>";var u=document.documentElement;u.insertBefore(t,u.firstChild);if(!!document.getElementById(s)){n.find.ID=function(y,x,w){if(typeof x.getElementById!=="undefined"&&!w){var v=x.getElementById(y[1]);return v?v.id===y[1]||typeof v.getAttributeNode!=="undefined"&&v.getAttributeNode("id").nodeValue===y[1]?[v]:ab:[]}};n.filter.ID=function(w,v){var x=typeof w.getAttributeNode!=="undefined"&&w.getAttributeNode("id");return w.nodeType===1&&x&&x.nodeValue===v}}u.removeChild(t)})();(function(){var s=document.createElement("div");s.appendChild(document.createComment(""));if(s.getElementsByTagName("*").length>0){n.find.TAG=function(v,w){var x=w.getElementsByTagName(v[1]);if(v[1]==="*"){var t=[];for(var u=0;x[u];u++){if(x[u].nodeType===1){t.push(x[u])}}x=t}return x}}s.innerHTML="<a href='#'></a>";if(s.firstChild&&typeof s.firstChild.getAttribute!=="undefined"&&s.firstChild.getAttribute("href")!=="#"){n.attrHandle.href=function(t){return t.getAttribute("href",2)}}})();if(document.querySelectorAll){(function(){var t=q,s=document.createElement("div");s.innerHTML="<p class='TEST'></p>";if(s.querySelectorAll&&s.querySelectorAll(".TEST").length===0){return}q=function(x,y,v,u){y=y||document;if(!u&&y.nodeType===9&&!e(y)){try{return r(y.querySelectorAll(x),v)}catch(w){}}return t(x,y,v,u)};q.find=t.find;q.filter=t.filter;q.selectors=t.selectors;q.matches=t.matches})()}if(document.getElementsByClassName&&document.documentElement.getElementsByClassName){(function(){var s=document.createElement("div");s.innerHTML="<div class='test e'></div><div class='test'></div>";if(s.getElementsByClassName("e").length===0){return}s.lastChild.className="e";if(s.getElementsByClassName("e").length===1){return}n.order.splice(1,0,"CLASS");n.find.CLASS=function(v,u,t){if(typeof u.getElementsByClassName!=="undefined"&&!t){return u.getElementsByClassName(v[1])}}})()}function f(y,t,u,A,s,B){var C=y=="previousSibling"&&!B;for(var w=0,x=A.length;w<x;w++){var z=A[w];if(z){if(C&&z.nodeType===1){z.sizcache=u;z.sizset=w}z=z[y];var v=false;while(z){if(z.sizcache===u){v=A[z.sizset];break}if(z.nodeType===1&&!B){z.sizcache=u;z.sizset=w}if(z.nodeName===t){v=z;break}z=z[y]}A[w]=v}}}function b(y,t,u,A,s,B){var C=y=="previousSibling"&&!B;for(var w=0,x=A.length;w<x;w++){var z=A[w];if(z){if(C&&z.nodeType===1){z.sizcache=u;z.sizset=w}z=z[y];var v=false;while(z){if(z.sizcache===u){v=A[z.sizset];break}if(z.nodeType===1){if(!B){z.sizcache=u;z.sizset=w}if(typeof t!=="string"){if(z===t){v=true;break}}else{if(q.filter(t,[z]).length>0){v=z;break}}}z=z[y]}A[w]=v}}}var l=document.compareDocumentPosition?function(s,t){return s.compareDocumentPosition(t)&16}:function(s,t){return s!==t&&(s.contains?s.contains(t):true)};var e=function(s){return s.nodeType===9&&s.documentElement.nodeName!=="HTML"||!!s.ownerDocument&&e(s.ownerDocument)};var m=function(v,x){var s=[],z="",y,t=x.nodeType?[x]:x;while((y=n.match.PSEUDO.exec(v))){z+=y[0];v=v.replace(n.match.PSEUDO,"")}v=n.relative[v]?v+"*":v;for(var w=0,u=t.length;w<u;w++){q(v,t[w],s)}return q.filter(z,s)};T.find=q;T.filter=q.filter;T.expr=q.selectors;T.expr[":"]=T.expr.filters;q.selectors.filters.hidden=function(s){return s.offsetWidth===0||s.offsetHeight===0};q.selectors.filters.visible=function(s){return s.offsetWidth>0||s.offsetHeight>0};q.selectors.filters.animated=function(s){return T.grep(T.timers,function(t){return s===t.elem}).length};T.multiFilter=function(s,u,t){if(t){s=":not("+s+")"}return q.matches(s,u)};T.dir=function(t,u){var v=[],s=t[u];while(s&&s!=document){if(s.nodeType==1){v.push(s)}s=s[u]}return v};T.nth=function(w,v,t,s){v=v||1;var u=0;for(;w;w=w[t]){if(w.nodeType==1&&++u==v){break}}return w};T.sibling=function(s,t){var u=[];for(;s;s=s.nextSibling){if(s.nodeType==1&&s!=t){u.push(s)}}return u};return;W.Sizzle=q})();T.event={add:function(e,h,f,b){if(e.nodeType==3||e.nodeType==8){return}if(e.setInterval&&e!=W){e=W}if(!f.guid){f.guid=this.guid++}if(b!==ab){var g=f;f=this.proxy(g);f.data=b}var i=T.data(e,"events")||T.data(e,"events",{}),d=T.data(e,"handle")||T.data(e,"handle",function(){return typeof T!=="undefined"&&!T.event.triggered?T.event.handle.apply(arguments.callee.elem,arguments):ab});d.elem=e;T.each(h.split(/\s+/),function(n,m){var l=m.split(".");m=l.shift();f.type=l.slice().sort().join(".");var k=i[m];if(T.event.specialAll[m]){T.event.specialAll[m].setup.call(e,b,l)}if(!k){k=i[m]={};if(!T.event.special[m]||T.event.special[m].setup.call(e,b,l)===false){if(e.addEventListener){e.addEventListener(m,d,false)}else{if(e.attachEvent){e.attachEvent("on"+m,d)}}}}k[f.guid]=f;T.event.global[m]=true});e=null},guid:1,global:{},remove:function(d,g,e){if(d.nodeType==3||d.nodeType==8){return}var h=T.data(d,"events"),i,k;if(h){if(g===ab||(typeof g==="string"&&g.charAt(0)==".")){for(var f in h){this.remove(d,f+(g||""))}}else{if(g.type){e=g.handler;g=g.type}T.each(g.split(/\s+/),function(p,n){var l=n.split(".");n=l.shift();var o=RegExp("(^|\\.)"+l.slice().sort().join(".*\\.")+"(\\.|$)");if(h[n]){if(e){delete h[n][e.guid]}else{for(var m in h[n]){if(o.test(h[n][m].type)){delete h[n][m]}}}if(T.event.specialAll[n]){T.event.specialAll[n].teardown.call(d,l)}for(i in h[n]){break}if(!i){if(!T.event.special[n]||T.event.special[n].teardown.call(d,l)===false){if(d.removeEventListener){d.removeEventListener(n,T.data(d,"handle"),false)}else{if(d.detachEvent){d.detachEvent("on"+n,T.data(d,"handle"))}}}i=null;delete h[n]}}})}for(i in h){break}if(!i){var b=T.data(d,"handle");if(b){b.elem=null}T.removeData(d,"events");T.removeData(d,"handle")}}},trigger:function(f,d,g,k){var h=f.type||f;if(!k){f=typeof f==="object"?f[aa]?f:T.extend(T.Event(h),f):T.Event(h);if(h.indexOf("!")>=0){f.type=h=h.slice(0,-1);f.exclusive=true}if(!g){f.stopPropagation();if(this.global[h]){T.each(T.cache,function(){if(this.events&&this.events[h]){T.event.trigger(f,d,this.handle.elem)}})}}if(!g||g.nodeType==3||g.nodeType==8){return ab}f.result=ab;f.target=g;d=T.makeArray(d);d.unshift(f)}f.currentTarget=g;var e=T.data(g,"handle");if(e){e.apply(g,d)}if((!g[h]||(T.nodeName(g,"a")&&h=="click"))&&g["on"+h]&&g["on"+h].apply(g,d)===false){f.result=false}if(!k&&g[h]&&!f.isDefaultPrevented()&&!(T.nodeName(g,"a")&&h=="click")){this.triggered=true;try{g[h]()}catch(b){}}this.triggered=false;if(!f.isPropagationStopped()){var i=g.parentNode||g.ownerDocument;if(i){T.event.trigger(f,d,i,true)}}},handle:function(d){var e,k;d=arguments[0]=T.event.fix(d||W.event);d.currentTarget=this;var b=d.type.split(".");d.type=b.shift();e=!b.length&&!d.exclusive;var f=RegExp("(^|\\.)"+b.slice().sort().join(".*\\.")+"(\\.|$)");k=(T.data(this,"events")||{})[d.type];for(var h in k){var g=k[h];if(e||f.test(g.type)){d.handler=g;d.data=g.data;var i=g.apply(this,arguments);if(i!==ab){d.result=i;if(i===false){d.preventDefault();d.stopPropagation()}}if(d.isImmediatePropagationStopped()){break}}}},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode metaKey newValue originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),fix:function(e){if(e[aa]){return e}var g=e;e=T.Event(g);for(var f=this.props.length,b;f;){b=this.props[--f];e[b]=g[b]}if(!e.target){e.target=e.srcElement||document}if(e.target.nodeType==3){e.target=e.target.parentNode}if(!e.relatedTarget&&e.fromElement){e.relatedTarget=e.fromElement==e.target?e.toElement:e.fromElement}if(e.pageX==null&&e.clientX!=null){var d=document.documentElement,h=document.body;e.pageX=e.clientX+(d&&d.scrollLeft||h&&h.scrollLeft||0)-(d.clientLeft||0);e.pageY=e.clientY+(d&&d.scrollTop||h&&h.scrollTop||0)-(d.clientTop||0)}if(!e.which&&((e.charCode||e.charCode===0)?e.charCode:e.keyCode)){e.which=e.charCode||e.keyCode}if(!e.metaKey&&e.ctrlKey){e.metaKey=e.ctrlKey}if(!e.which&&e.button){e.which=(e.button&1?1:(e.button&2?3:(e.button&4?2:0)))}return e},proxy:function(b,d){d=d||function(){return b.apply(this,arguments)};d.guid=b.guid=b.guid||d.guid||this.guid++;return d},special:{ready:{setup:P,teardown:function(){}}},specialAll:{live:{setup:function(d,b){T.event.add(this,b[0],af)},teardown:function(b){if(b.length){var e=0,d=RegExp("(^|\\.)"+b[0]+"(\\.|$)");T.each((T.data(this,"events").live||{}),function(){if(d.test(this.type)){e++}});if(e<1){T.event.remove(this,b[0],af)}}}}}};T.Event=function(b){if(!this.preventDefault){return new T.Event(b)}if(b&&b.type){this.originalEvent=b;this.type=b.type}else{this.type=b}this.timeStamp=ad();this[aa]=true};function X(){return false}function J(){return true}T.Event.prototype={preventDefault:function(){this.isDefaultPrevented=J;var b=this.originalEvent;if(!b){return}if(b.preventDefault){b.preventDefault()}b.returnValue=false},stopPropagation:function(){this.isPropagationStopped=J;var b=this.originalEvent;if(!b){return}if(b.stopPropagation){b.stopPropagation()}b.cancelBubble=true},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=J;this.stopPropagation()},isDefaultPrevented:X,isPropagationStopped:X,isImmediatePropagationStopped:X};var ah=function(d){var e=d.relatedTarget;while(e&&e!=this){try{e=e.parentNode}catch(b){e=this}}if(e!=this){d.type=d.data;T.event.handle.apply(this,arguments)}};T.each({mouseover:"mouseenter",mouseout:"mouseleave"},function(b,d){T.event.special[d]={setup:function(){T.event.add(this,b,ah,d)},teardown:function(){T.event.remove(this,b,ah)}}});T.fn.extend({bind:function(d,b,e){return d=="unload"?this.one(d,b,e):this.each(function(){T.event.add(this,d,e||b,e&&b)})},one:function(d,b,e){var f=T.event.proxy(e||b,function(g){T(this).unbind(g,f);return(e||b).apply(this,arguments)});return this.each(function(){T.event.add(this,d,f,e&&b)})},unbind:function(b,d){return this.each(function(){T.event.remove(this,b,d)})},trigger:function(d,b){return this.each(function(){T.event.trigger(d,b,this)})},triggerHandler:function(e,b){if(this[0]){var d=T.Event(e);d.preventDefault();d.stopPropagation();T.event.trigger(d,b,this[0]);return d.result}},toggle:function(b){var e=arguments,d=1;while(d<e.length){T.event.proxy(b,e[d++])}return this.click(T.event.proxy(b,function(f){this.lastToggle=(this.lastToggle||0)%d;f.preventDefault();return e[this.lastToggle++].apply(this,arguments)||false}))},hover:function(d,b){return this.mouseenter(d).mouseleave(b)},ready:function(b){P();if(T.isReady){b.call(document,T)}else{T.readyList.push(b)}return this},live:function(b,d){var e=T.event.proxy(d);e.guid+=this.selector+b;T(document).bind(Z(b,this.selector),this.selector,e);return this},die:function(b,d){T(document).unbind(Z(b,this.selector),d?{guid:d.guid+this.selector+b}:null);return this}});function af(b){var f=RegExp("(^|\\.)"+b.type+"(\\.|$)"),d=true,e=[];T.each(T.data(this,"events").live||[],function(i,h){if(f.test(h.type)){var g=T(b.target).closest(h.data)[0];if(g){e.push({elem:g,fn:h})}}});e.sort(function(g,h){return T.data(g.elem,"closest")-T.data(h.elem,"closest")});T.each(e,function(){if(this.fn.call(this.elem,b,this.fn.data)===false){return(d=false)}});return d}function Z(b,d){return["live",b,d.replace(/\./g,"`").replace(/ /g,"|")].join(".")}T.extend({isReady:false,readyList:[],ready:function(){if(!T.isReady){T.isReady=true;if(T.readyList){T.each(T.readyList,function(){this.call(document,T)});T.readyList=null}T(document).triggerHandler("ready")}}});var G=false;function P(){if(G){return}G=true;if(document.addEventListener){document.addEventListener("DOMContentLoaded",function(){document.removeEventListener("DOMContentLoaded",arguments.callee,false);T.ready()},false)}else{if(document.attachEvent){document.attachEvent("onreadystatechange",function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",arguments.callee);T.ready()}});if(document.documentElement.doScroll&&W==W.top){(function(){if(T.isReady){return}try{document.documentElement.doScroll("left")}catch(b){setTimeout(arguments.callee,0);return}T.ready()})()}}}T.event.add(W,"load",T.ready)}T.each(("blur,focus,load,resize,scroll,unload,click,dblclick,mousedown,mouseup,mousemove,mouseover,mouseout,mouseenter,mouseleave,change,select,submit,keydown,keypress,keyup,error").split(","),function(b,d){T.fn[d]=function(e){return e?this.bind(d,e):this.trigger(d)}});T(W).bind("unload",function(){for(var b in T.cache){if(b!=1&&T.cache[b].handle){T.event.remove(T.cache[b].handle.elem)}}});(function(){T.support={};var h=document.documentElement,g=document.createElement("script"),b=document.createElement("div"),d="script"+(new Date).getTime();b.style.display="none";b.innerHTML='   <link/><table></table><a href="/a" style="color:red;float:left;opacity:.5;">a</a><select><option>text</option></select><object><param/></object>';var f=b.getElementsByTagName("*"),i=b.getElementsByTagName("a")[0];if(!f||!f.length||!i){return}T.support={leadingWhitespace:b.firstChild.nodeType==3,tbody:!b.getElementsByTagName("tbody").length,objectAll:!!b.getElementsByTagName("object")[0].getElementsByTagName("*").length,htmlSerialize:!!b.getElementsByTagName("link").length,style:/red/.test(i.getAttribute("style")),hrefNormalized:i.getAttribute("href")==="/a",opacity:i.style.opacity==="0.5",cssFloat:!!i.style.cssFloat,scriptEval:false,noCloneEvent:true,boxModel:null};g.type="text/javascript";try{g.appendChild(document.createTextNode("window."+d+"=1;"))}catch(e){}h.insertBefore(g,h.firstChild);if(W[d]){T.support.scriptEval=true;delete W[d]}h.removeChild(g);if(b.attachEvent&&b.fireEvent){b.attachEvent("onclick",function(){T.support.noCloneEvent=false;b.detachEvent("onclick",arguments.callee)});b.cloneNode(true).fireEvent("onclick")}T(function(){var k=document.createElement("div");k.style.width=k.style.paddingLeft="1px";document.body.appendChild(k);T.boxModel=T.support.boxModel=k.offsetWidth===2;document.body.removeChild(k).style.display="none"})})();var H=T.support.cssFloat?"cssFloat":"styleFloat";T.props={"for":"htmlFor","class":"className","float":H,cssFloat:H,styleFloat:H,readonly:"readOnly",maxlength:"maxLength",cellspacing:"cellSpacing",rowspan:"rowSpan",tabindex:"tabIndex"};T.fn.extend({_load:T.fn.load,load:function(g,d,b){if(typeof g!=="string"){return this._load(g)}var e=g.indexOf(" ");if(e>=0){var i=g.slice(e,g.length);g=g.slice(0,e)}var f="GET";if(d){if(T.isFunction(d)){b=d;d=null}else{if(typeof d==="object"){d=T.param(d);f="POST"}}}var h=this;T.ajax({url:g,type:f,dataType:"html",data:d,complete:function(l,k){if(k=="success"||k=="notmodified"){h.html(i?T("<div/>").append(l.responseText.replace(/<script(.|\s)*?\/script>/g,"")).find(i):l.responseText)}if(b){h.each(b,[l.responseText,k,l])}}});return this},serialize:function(){return T.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?T.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||/select|textarea/i.test(this.nodeName)||/text|hidden|password|search/i.test(this.type))}).map(function(e,d){var b=T(this).val();return b==null?null:T.isArray(b)?T.map(b,function(f,g){return{name:d.name,value:f}}):{name:d.name,value:b}}).get()}});T.each("ajaxStart,ajaxStop,ajaxComplete,ajaxError,ajaxSuccess,ajaxSend".split(","),function(d,b){T.fn[b]=function(e){return this.bind(b,e)}});var N=ad();T.extend({get:function(f,d,b,e){if(T.isFunction(d)){b=d;d=null}return T.ajax({type:"GET",url:f,data:d,success:b,dataType:e})},getScript:function(d,b){return T.get(d,null,b,"script")},getJSON:function(e,d,b){return T.get(e,d,b,"json")},post:function(f,d,b,e){if(T.isFunction(d)){b=d;d={}}return T.ajax({type:"POST",url:f,data:d,success:b,dataType:e})},ajaxSetup:function(b){T.extend(T.ajaxSettings,b)},ajaxSettings:{url:location.href,global:true,type:"GET",contentType:"application/x-www-form-urlencoded",processData:true,async:true,xhr:function(){return W.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest()},accepts:{xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"}},lastModified:{},ajax:function(n){n=T.extend(true,n,T.extend(true,{},T.ajaxSettings,n));var b,u=/=\?(&|$)/g,h,d,t=n.type.toUpperCase();if(n.data&&n.processData&&typeof n.data!=="string"){n.data=T.param(n.data)}if(n.dataType=="jsonp"){if(t=="GET"){if(!n.url.match(u)){n.url+=(n.url.match(/\?/)?"&":"?")+(n.jsonp||"callback")+"=?"}}else{if(!n.data||!n.data.match(u)){n.data=(n.data?n.data+"&":"")+(n.jsonp||"callback")+"=?"}}n.dataType="json"}if(n.dataType=="json"&&(n.data&&n.data.match(u)||n.url.match(u))){b="jsonp"+N++;if(n.data){n.data=(n.data+"").replace(u,"="+b+"$1")}n.url=n.url.replace(u,"="+b+"$1");n.dataType="script";W[b]=function(x){d=x;r();o();W[b]=ab;try{delete W[b]}catch(w){}if(s){s.removeChild(f)}}}if(n.dataType=="script"&&n.cache==null){n.cache=false}if(n.cache===false&&t=="GET"){var v=ad();var e=n.url.replace(/(\?|&)_=.*?(&|$)/,"$1_="+v+"$2");n.url=e+((e==n.url)?(n.url.match(/\?/)?"&":"?")+"_="+v:"")}if(n.data&&t=="GET"){n.url+=(n.url.match(/\?/)?"&":"?")+n.data;n.data=null}if(n.global&&!T.active++){T.event.trigger("ajaxStart")}var i=/^(\w+:)?\/\/([^\/?#]+)/.exec(n.url);if(n.dataType=="script"&&t=="GET"&&i&&(i[1]&&i[1]!=location.protocol||i[2]!=location.host)){var s=document.getElementsByTagName("head")[0];var f=document.createElement("script");f.src=n.url;if(n.scriptCharset){f.charset=n.scriptCharset}if(!b){var l=false;f.onload=f.onreadystatechange=function(){if(!l&&(!this.readyState||this.readyState=="loaded"||this.readyState=="complete")){l=true;r();o();f.onload=f.onreadystatechange=null;s.removeChild(f)}}}s.appendChild(f);return ab}var p=false;var q=n.xhr();if(n.username){q.open(t,n.url,n.async,n.username,n.password)}else{q.open(t,n.url,n.async)}try{if(n.data){q.setRequestHeader("Content-Type",n.contentType)}if(n.ifModified){q.setRequestHeader("If-Modified-Since",T.lastModified[n.url]||"Thu, 01 Jan 1970 00:00:00 GMT")}q.setRequestHeader("X-Requested-With","XMLHttpRequest");q.setRequestHeader("Accept",n.dataType&&n.accepts[n.dataType]?n.accepts[n.dataType]+", */*":n.accepts._default)}catch(g){}if(n.beforeSend&&n.beforeSend(q,n)===false){if(n.global&&!--T.active){T.event.trigger("ajaxStop")}q.abort();return false}if(n.global){T.event.trigger("ajaxSend",[q,n])}var m=function(y){if(q.readyState==0){if(k){clearInterval(k);k=null;if(n.global&&!--T.active){T.event.trigger("ajaxStop")}}}else{if(!p&&q&&(q.readyState==4||y=="timeout")){p=true;if(k){clearInterval(k);k=null}h=y=="timeout"?"timeout":!T.httpSuccess(q)?"error":n.ifModified&&T.httpNotModified(q,n.url)?"notmodified":"success";if(h=="success"){try{d=T.httpData(q,n.dataType,n)}catch(w){h="parsererror"}}if(h=="success"){var x;try{x=q.getResponseHeader("Last-Modified")}catch(w){}if(n.ifModified&&x){T.lastModified[n.url]=x}if(!b){r()}}else{T.handleError(n,q,h)}o();if(y){q.abort()}if(n.async){q=null}}}};if(n.async){var k=setInterval(m,13);if(n.timeout>0){setTimeout(function(){if(q&&!p){m("timeout")}},n.timeout)}}try{q.send(n.data)}catch(g){T.handleError(n,q,null,g)}if(!n.async){m()}function r(){if(n.success){n.success(d,h)}if(n.global){T.event.trigger("ajaxSuccess",[q,n])}}function o(){if(n.complete){n.complete(q,h)}if(n.global){T.event.trigger("ajaxComplete",[q,n])}if(n.global&&!--T.active){T.event.trigger("ajaxStop")}}return q},handleError:function(e,b,f,d){if(e.error){e.error(b,f,d)}if(e.global){T.event.trigger("ajaxError",[b,e,d])}},active:0,httpSuccess:function(b){try{return !b.status&&location.protocol=="file:"||(b.status>=200&&b.status<300)||b.status==304||b.status==1223}catch(d){}return false},httpNotModified:function(d,f){try{var b=d.getResponseHeader("Last-Modified");return d.status==304||b==T.lastModified[f]}catch(e){}return false},httpData:function(b,e,f){var g=b.getResponseHeader("content-type"),h=e=="xml"||!e&&g&&g.indexOf("xml")>=0,d=h?b.responseXML:b.responseText;if(h&&d.documentElement.tagName=="parsererror"){throw"parsererror"}if(f&&f.dataFilter){d=f.dataFilter(d,e)}if(typeof d==="string"){if(e=="script"){T.globalEval(d)}if(e=="json"){d=W["eval"]("("+d+")")}}return d},param:function(f){var d=[];function b(h,g){d[d.length]=encodeURIComponent(h)+"="+encodeURIComponent(g)}if(T.isArray(f)||f.jquery){T.each(f,function(){b(this.name,this.value)})}else{for(var e in f){if(T.isArray(f[e])){T.each(f[e],function(){b(e,this)})}else{b(e,T.isFunction(f[e])?f[e]():f[e])}}}return d.join("&").replace(/%20/g,"+")}});var V={},U,ae=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]];function K(d,e){var b={};T.each(ae.concat.apply([],ae.slice(0,e)),function(){b[this]=d});return b}T.fn.extend({show:function(e,b){if(e){return this.animate(K("show",3),e,b)}else{for(var g=0,i=this.length;g<i;g++){var k=T.data(this[g],"olddisplay");this[g].style.display=k||"";if(T.css(this[g],"display")==="none"){var h=this[g].tagName,d;if(V[h]){d=V[h]}else{var f=T("<"+h+" />").appendTo("body");d=f.css("display");if(d==="none"){d="block"}f.remove();V[h]=d}T.data(this[g],"olddisplay",d)}}for(var g=0,i=this.length;g<i;g++){this[g].style.display=T.data(this[g],"olddisplay")||""}return this}},hide:function(d,b){if(d){return this.animate(K("hide",3),d,b)}else{for(var e=0,f=this.length;e<f;e++){var g=T.data(this[e],"olddisplay");if(!g&&g!=="none"){T.data(this[e],"olddisplay",T.css(this[e],"display"))}}for(var e=0,f=this.length;e<f;e++){this[e].style.display="none"}return this}},_toggle:T.fn.toggle,toggle:function(b,d){var e=typeof b==="boolean";return T.isFunction(b)&&T.isFunction(d)?this._toggle.apply(this,arguments):b==null||e?this.each(function(){var f=e?b:T(this).is(":hidden");T(this)[f?"show":"hide"]()}):this.animate(K("toggle",3),b,d)},fadeTo:function(e,b,d){return this.animate({opacity:b},e,d)},animate:function(b,f,d,e){var g=T.speed(f,d,e);return this[g.queue===false?"each":"queue"](function(){var i=T.extend({},g),l,h=this.nodeType==1&&T(this).is(":hidden"),k=this;for(l in b){if(b[l]=="hide"&&h||b[l]=="show"&&!h){return i.complete.call(this)}if((l=="height"||l=="width")&&this.style){i.display=T.css(this,"display");i.overflow=this.style.overflow}}if(i.overflow!=null){this.style.overflow="hidden"}i.curAnim=T.extend({},b);T.each(b,function(r,n){var o=new T.fx(k,i,r);if(/toggle|show|hide/.test(n)){o[n=="toggle"?h?"show":"hide":n](b)}else{var p=n.toString().match(/^([+-]=)?([\d+-.]+)(.*)$/),m=o.cur(true)||0;if(p){var s=parseFloat(p[2]),q=p[3]||"px";if(q!="px"){k.style[r]=(s||1)+q;m=((s||1)/o.cur(true))*m;k.style[r]=m+q}if(p[1]){s=((p[1]=="-="?-1:1)*s)+m}o.custom(m,s,q)}else{o.custom(m,n,"")}}});return true})},stop:function(d,e){var b=T.timers;if(d){this.queue([])}this.each(function(){for(var f=b.length-1;f>=0;f--){if(b[f].elem==this){if(e){b[f](true)}b.splice(f,1)}}});if(!e){this.dequeue()}return this}});T.each({slideDown:K("show",1),slideUp:K("hide",1),slideToggle:K("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"}},function(d,b){T.fn[d]=function(f,e){return this.animate(b,f,e)}});T.extend({speed:function(d,b,e){var f=typeof d==="object"?d:{complete:e||!e&&b||T.isFunction(d)&&d,duration:d,easing:e&&b||b&&!T.isFunction(b)&&b};f.duration=T.fx.off?0:typeof f.duration==="number"?f.duration:T.fx.speeds[f.duration]||T.fx.speeds._default;f.old=f.complete;f.complete=function(){if(f.queue!==false){T(this).dequeue()}if(T.isFunction(f.old)){f.old.call(this)}};return f},easing:{linear:function(d,b,f,e){return f+e*d},swing:function(d,b,f,e){return((-Math.cos(d*Math.PI)/2)+0.5)*e+f}},timers:[],fx:function(d,e,b){this.options=e;this.elem=d;this.prop=b;if(!e.orig){e.orig={}}}});T.fx.prototype={update:function(){if(this.options.step){this.options.step.call(this.elem,this.now,this)}(T.fx.step[this.prop]||T.fx.step._default)(this);if((this.prop=="height"||this.prop=="width")&&this.elem.style){this.elem.style.display="block"}},cur:function(b){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null)){return this.elem[this.prop]}var d=parseFloat(T.css(this.elem,this.prop,b));return d&&d>-10000?d:parseFloat(T.curCSS(this.elem,this.prop))||0},custom:function(b,d,e){this.startTime=ad();this.start=b;this.end=d;this.unit=e||this.unit||"px";this.now=this.start;this.pos=this.state=0;var g=this;function f(h){return g.step(h)}f.elem=this.elem;if(f()&&T.timers.push(f)&&!U){U=setInterval(function(){var h=T.timers;for(var i=0;i<h.length;i++){if(!h[i]()){h.splice(i--,1)}}if(!h.length){clearInterval(U);U=ab}},13)}},show:function(){this.options.orig[this.prop]=T.attr(this.elem.style,this.prop);this.options.show=true;this.custom(this.prop=="width"||this.prop=="height"?1:0,this.cur());T(this.elem).show()},hide:function(){this.options.orig[this.prop]=T.attr(this.elem.style,this.prop);this.options.hide=true;this.custom(this.cur(),0)},step:function(e){var f=ad();if(e||f>=this.options.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();this.options.curAnim[this.prop]=true;var h=true;for(var g in this.options.curAnim){if(this.options.curAnim[g]!==true){h=false}}if(h){if(this.options.display!=null){this.elem.style.overflow=this.options.overflow;this.elem.style.display=this.options.display;if(T.css(this.elem,"display")=="none"){this.elem.style.display="block"}}if(this.options.hide){T(this.elem).hide()}if(this.options.hide||this.options.show){for(var d in this.options.curAnim){T.attr(this.elem.style,d,this.options.orig[d])}}this.options.complete.call(this.elem)}return false}else{var b=f-this.startTime;this.state=b/this.options.duration;this.pos=T.easing[this.options.easing||(T.easing.swing?"swing":"linear")](this.state,b,0,1,this.options.duration);this.now=this.start+((this.end-this.start)*this.pos);this.update()}return true}};T.extend(T.fx,{speeds:{slow:600,fast:200,_default:400},step:{opacity:function(b){T.attr(b.elem.style,"opacity",b.now)},_default:function(b){if(b.elem.style&&b.elem.style[b.prop]!=null){b.elem.style[b.prop]=b.now+b.unit}else{b.elem[b.prop]=b.now}}}});if(document.documentElement.getBoundingClientRect){T.fn.offset=function(){if(!this[0]){return{top:0,left:0}}if(this[0]===this[0].ownerDocument.body){return T.offset.bodyOffset(this[0])}var h=this[0].getBoundingClientRect(),e=this[0].ownerDocument,i=e.body,k=e.documentElement,b=k.clientTop||i.clientTop||0,d=k.clientLeft||i.clientLeft||0,f=h.top+(self.pageYOffset||T.boxModel&&k.scrollTop||i.scrollTop)-b,g=h.left+(self.pageXOffset||T.boxModel&&k.scrollLeft||i.scrollLeft)-d;return{top:f,left:g}}}else{T.fn.offset=function(){if(!this[0]){return{top:0,left:0}}if(this[0]===this[0].ownerDocument.body){return T.offset.bodyOffset(this[0])}T.offset.initialized||T.offset.initialize();var h=this[0],l=h.offsetParent,m=h,b=h.ownerDocument,e,k=b.documentElement,g=b.body,f=b.defaultView,n=f.getComputedStyle(h,null),d=h.offsetTop,i=h.offsetLeft;while((h=h.parentNode)&&h!==g&&h!==k){e=f.getComputedStyle(h,null);d-=h.scrollTop,i-=h.scrollLeft;if(h===l){d+=h.offsetTop,i+=h.offsetLeft;if(T.offset.doesNotAddBorder&&!(T.offset.doesAddBorderForTableAndCells&&/^t(able|d|h)$/i.test(h.tagName))){d+=parseInt(e.borderTopWidth,10)||0,i+=parseInt(e.borderLeftWidth,10)||0}m=l,l=h.offsetParent}if(T.offset.subtractsBorderForOverflowNotVisible&&e.overflow!=="visible"){d+=parseInt(e.borderTopWidth,10)||0,i+=parseInt(e.borderLeftWidth,10)||0}n=e}if(n.position==="relative"||n.position==="static"){d+=g.offsetTop,i+=g.offsetLeft}if(n.position==="fixed"){d+=Math.max(k.scrollTop,g.scrollTop),i+=Math.max(k.scrollLeft,g.scrollLeft)}return{top:d,left:i}}}T.offset={initialize:function(){if(this.initialized){return}var e=document.body,l=document.createElement("div"),i,k,b,h,d,m,g=e.style.marginTop,f='<div style="position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;"><div></div></div><table style="position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;" cellpadding="0" cellspacing="0"><tr><td></td></tr></table>';d={position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"};for(m in d){l.style[m]=d[m]}l.innerHTML=f;e.insertBefore(l,e.firstChild);i=l.firstChild,k=i.firstChild,h=i.nextSibling.firstChild.firstChild;this.doesNotAddBorder=(k.offsetTop!==5);this.doesAddBorderForTableAndCells=(h.offsetTop===5);i.style.overflow="hidden",i.style.position="relative";this.subtractsBorderForOverflowNotVisible=(k.offsetTop===-5);e.style.marginTop="1px";this.doesNotIncludeMarginInBodyOffset=(e.offsetTop===0);e.style.marginTop=g;e.removeChild(l);this.initialized=true},bodyOffset:function(e){T.offset.initialized||T.offset.initialize();var b=e.offsetTop,d=e.offsetLeft;if(T.offset.doesNotIncludeMarginInBodyOffset){b+=parseInt(T.curCSS(e,"marginTop",true),10)||0,d+=parseInt(T.curCSS(e,"marginLeft",true),10)||0}return{top:b,left:d}}};T.fn.extend({position:function(){var d=0,e=0,g;if(this[0]){var f=this.offsetParent(),b=this.offset(),h=/^body|html$/i.test(f[0].tagName)?{top:0,left:0}:f.offset();b.top-=Y(this,"marginTop");b.left-=Y(this,"marginLeft");h.top+=Y(f,"borderTopWidth");h.left+=Y(f,"borderLeftWidth");g={top:b.top-h.top,left:b.left-h.left}}return g},offsetParent:function(){var b=this[0].offsetParent||document.body;while(b&&(!/^body|html$/i.test(b.tagName)&&T.css(b,"position")=="static")){b=b.offsetParent}return T(b)}});T.each(["Left","Top"],function(d,e){var b="scroll"+e;T.fn[b]=function(f){if(!this[0]){return null}return f!==ab?this.each(function(){this==W||this==document?W.scrollTo(!d?f:T(W).scrollLeft(),d?f:T(W).scrollTop()):this[b]=f}):this[0]==W||this[0]==document?self[d?"pageYOffset":"pageXOffset"]||T.boxModel&&document.documentElement[b]||document.body[b]:this[0][b]}});T.each(["Height","Width"],function(d,f){var h=d?"Left":"Top",e=d?"Right":"Bottom",g=f.toLowerCase();T.fn["inner"+f]=function(){return this[0]?T.css(this[0],g,false,"padding"):null};T.fn["outer"+f]=function(i){return this[0]?T.css(this[0],g,false,i?"margin":"border"):null};var b=f.toLowerCase();T.fn[b]=function(i){return this[0]==W?document.compatMode=="CSS1Compat"&&document.documentElement["client"+f]||document.body["client"+f]:this[0]==document?Math.max(document.documentElement["client"+f],document.body["scroll"+f],document.documentElement["scroll"+f],document.body["offset"+f],document.documentElement["offset"+f]):i===ab?(this.length?T.css(this[0],b):null):this.css(b,typeof i==="string"?i:i+"px")}})})();window.jq4gv=jQuery.noConflict(true);var jsGameViewer=function(){return{name:"jsgameviewer",version:"1.0a",length:0,WEIQI:0,DAOQI:1,EN_US:"en_us",ZH_CN:"zh_cn",LOCALES:["en_us","zh_cn"],CONFIG:{baseDir:"/jsgameviewer/",viewDir:"/jsgameviewer/view/",locale:jsgvTranslations.locale,gameType:0,boardSize:19,playerInterval:5,observerInterval:15,container:null},debug:function(b){if(typeof(console)!="undefined"){console.log(b)}},getGameId:function(b){if(b==undefined){this.length++;for(b=1;this["GV"+b]!=null;b++){}}return"GV"+b},createClass:function(){return function(){this.initialize.apply(this,arguments)}},clone:function(e){if(typeof(e)!="object"){return e}if(e==null){return e}var d=new Object();for(var b in e){d[b]=this.clone(e[b])}return d},notNull:function(b){return b!=undefined&&b!=null&&jq4gv.trim(b).length>0},getId:function(b,d){return b+"-"+d},showAjaxError:function(e,d){var b=jsgvTranslations.error_thrown+"\n";if(e!=undefined){b+=e+" "}if(d!=undefined){b+=d}alert(b.substr(0,1000))}}}();var jsgv=jsGameViewer;jsGameViewer.model=function(){var u=0;var z=1;var s=2;var e=3;var B=0;var q=1;var o=2;var r=0;var D=1;var m=2;var y=0;var t=1;var g=2;var h=3;var x=4;var i=5;var b=6;var v=7;var k=8;var p=9;var l=jsGameViewer.createClass();jq4gv.extend(l.prototype,{initialize:function(F,E){this.val=F;this.depth=0;if(E!=undefined&&E!=null){this.depth=E}}});var C=jsGameViewer.createClass();jq4gv.extend(C.prototype,{initialize:function(E,I,F,G,H){this.x=E;this.y=I;this.id=E+"-"+I;this.color=0;if(F!=undefined&&F!=null){this.color=F}this.moveNumber=null;if(G!=undefined&&G!=null){this.moveNumber=G}this.deleteFlag=false;if(H){this.deleteFlag=true}}});var w=jsGameViewer.createClass();jq4gv.extend(w,Array);jq4gv.extend(w.prototype,{initialize:function(E,F){this.gameType=E;this.size=F;this.reset()},isNeighbor:function(F,H,E,G){if(this.gameType==jsGameViewer.DAOQI){if(F==E){return H==(G+1)%this.size||H==(G-1+this.size)%this.size}if(H==G){return F==(E+1)%this.size||F==(E-1+this.size)%this.size}return false}else{if(F==E){return H==G+1||H==G-1}if(H==G){return F==E+1||F==E-1}return false}},normalize:function(E){if(E<0){return E+this.size}if(E>=this.size){return E-this.size}return E},reset:function(){for(var E=0;E<this.size;E++){this[E]=new Array(this.size);for(j=0;j<this.size;j++){this[E][j]=0}}},copyFrom:function(E){for(var G=0;G<this.size;G++){for(var F=0;F<this.size;F++){this[G][F]=E[G][F]}}},getDeadGroup:function(E,G){if(this.gameType==jsGameViewer.DAOQI){E=this.normalize(E);G=this.normalize(G)}else{if(E<0||E>=this.size||G<0||G>=this.size){return null}}if(this[E][G]==0){return null}if(this.gameType==jsGameViewer.DAOQI){if(this[this.normalize(E-1)][G]==0||this[this.normalize(E+1)][G]==0||this[E][this.normalize(G-1)]==0||this[E][this.normalize(G+1)]==0){return null}}else{if((E>0&&this[E-1][G]==0)||(E<this.size-1&&this[E+1][G]==0)||(G>0&&this[E][G-1]==0)||(G<this.size-1&&this[E][G+1]==0)){return null}}var F=new Array();F.color=this[E][G];F.push([E,G]);F[E+"-"+G]=true;if(this.gameType==jsGameViewer.DAOQI){if(this.expandDeadGroup(F,E-1,G)){return null}if(this.expandDeadGroup(F,E+1,G)){return null}if(this.expandDeadGroup(F,E,G-1)){return null}if(this.expandDeadGroup(F,E,G+1)){return null}}else{if(E>0&&this.expandDeadGroup(F,E-1,G)){return null}if(E<this.size-1&&this.expandDeadGroup(F,E+1,G)){return null}if(G>0&&this.expandDeadGroup(F,E,G-1)){return null}if(G<this.size-1&&this.expandDeadGroup(F,E,G+1)){return null}}return F},expandDeadGroup:function(F,E,G){if(this.gameType==jsGameViewer.DAOQI){E=this.normalize(E);G=this.normalize(G)}if(F[E+"-"+G]!=null){return false}if(this[E][G]!=F.color){return false}if(this.gameType==jsGameViewer.DAOQI){if(this[this.normalize(E-1)][G]==0||this[this.normalize(E+1)][G]==0||this[E][this.normalize(G-1)]==0||this[E][this.normalize(G+1)]==0){return true}}else{if((E>0&&this[E-1][G]==0)||(E<this.size-1&&this[E+1][G]==0)||(G>0&&this[E][G-1]==0)||(G<this.size-1&&this[E][G+1]==0)){return true}}F.push([E,G]);F[E+"-"+G]=true;if(this.gameType==jsGameViewer.DAOQI){if(this.expandDeadGroup(F,E-1,G)){return true}if(this.expandDeadGroup(F,E+1,G)){return true}if(this.expandDeadGroup(F,E,G-1)){return true}if(this.expandDeadGroup(F,E,G+1)){return true}}else{if(E>0&&this.expandDeadGroup(F,E-1,G)){return true}if(E<this.size-1&&this.expandDeadGroup(F,E+1,G)){return true}if(G>0&&this.expandDeadGroup(F,E,G-1)){return true}if(G<this.size-1&&this.expandDeadGroup(F,E,G+1)){return true}}return false}});var A=jsGameViewer.createClass();jq4gv.extend(A.prototype,{initialize:function(E){this.type=r;this.parent=E;this.children=new Array();this.moveNumber=0;this.depth=0;this.points=new Array();this.processed=false;this.blackPrisoners=0;this.blackPrisonerPoints=[];this.whitePrisoners=0;this.whitePrisonerPoints=[]},isRoot:function(){return this.parent==null},hasChildren:function(){return this.children.length>0},firstChild:function(){if(this.children.length>0){return this.children[0]}return null},childThatMatches:function(E,H){for(var F=0;F<this.children.length;F++){var G=this.children[F];if(G.x==E&&G.y==H){return F}}return null},isOnBranch:function(){return this.depth>1},isDummyNode:function(){return this.type==r&&!this.isRoot()&&this.comment==null&&this.marks==null},hasComment:function(){return this.comment!=undefined&&this.comment!=null&&jq4gv.trim(this.comment).length>0},hasBranches:function(){return this.children.length>1},toString:function(){var E="";var F="EMPTY";if(this.type==D){F="MOVE"}else{if(this.type==m){F="PASS"}}var G=E+"Node("+F+", "+this.moveNumber;if(this.type==D||this.type==m){G+=", "+(this.color==z?"black":"white")}if(this.type==D){G+=", "+this.x+","+this.y}G+=")";return G}});var f=jsGameViewer.createClass();jq4gv.extend(f.prototype,{initialize:function(E){this.type=E;this.charset="";this.name="";this.boardSize=19;this.rule="";this.handicap=0;this.komi=0;this.blackName="";this.blackRank="";this.whiteName="";this.whiteRank="";this.date="";this.place="";this.result="";this._moves=0;this.rootNode=new A(null)},isFinished:function(){return this.result&&this.result.length>0},getMoves:function(){if(this._moves==0){var E=this.rootNode;while(E.hasChildren()){E=E.children[0];if(E.moveNumber!=undefined&&E.moveNumber!=null){this._moves=E.moveNumber}}}return this._moves},getFirstPlayer:function(){if(!this.firstPlayer){if(this.handicap>1){this.firstPlayer=s}else{var E=this.rootNode;while(this.firstPlayer==u&&E.hasChildren()){E=E.children[0];if(E.type==D||E.type==m){this.firstPlayer=E.color}}}}return this.firstPlayer},getId:function(){var E=this.url;return E},getTitle:function(){var E="";if(this.name){E+=this.name+": "}if(this.whiteName){E+=this.whiteName}else{E+="Unknown Player"}E+="(W) - ";if(c.game.blackName){E+=c.game.blackName}else{E+="Unknown Player"}E+="(B)";if(this.result){E+="   "+this.result}if(this.date){E+="   "+this.date}if(this.place){E+="   "+this.place}return E}});var n=jsGameViewer.createClass();jq4gv.extend(n.prototype,{initialize:function(E){this.game=E;this.board=new w(E.type,E.boardSize);this.currentNode=E.rootNode;this.rootNode=this.currentNode;this.blackPrisoners=0;this.blackPrisonerPoints=[];this.whitePrisoners=0;this.whitePrisonerPoints=[];this.moveNumbers=new Object();this.tempMoves=new Array();this.processCurrentNode()},isFirst:function(){return this.currentNode.isRoot()},isLast:function(){return !this.currentNode.hasChildren()},isOnBranch:function(){return this.currentNode.isOnBranch()},getXYs:function(){var E=this.currentNode;var F=[];while(E){if(E.type==D){F.unshift([E.x,E.y])}E=E.parent}return F},getNextPlayer:function(){if(this.currentNode==this.rootNode){return this.game.getFirstPlayer()}var F=this.currentNode;var E=F.color;while(E!=z&&E!=s&&!F.isRoot()){F=F.parent;E=F.color}if(E==z){E=s}else{if(E==s){E=z}else{F=this.currentNode;while(E!=z&&E!=s&&F.hasChildren()){F=F.children[0];E=F.color}}}if(!E||E==u){E=z}return E},getMoveNumber:function(F,G){var E=this.moveNumbers[jsGameViewer.getId(F,G)];if(E instanceof Number){return E}if(E!=undefined&&E!=null){return E.val}return 0},handleDeadGroup:function(F){var E=this;if(F!=null){if(F.color==z){E.currentNode.blackPrisoners+=F.length;E.blackPrisoners+=F.length}else{E.currentNode.whitePrisoners+=F.length;E.whitePrisoners+=F.length}jq4gv.each(F,function(I,K){var H=K[0],M=K[1],J=E.moveNumbers[jsGameViewer.getId(H,M)];var L=[H,M,F.color,J,E.currentNode.moveNumber];if(F.color==z){E.currentNode.blackPrisonerPoints.push(L);E.blackPrisonerPoints.push(L)}else{E.currentNode.whitePrisonerPoints.push(L);E.whitePrisonerPoints.push(L)}E.board[H][M]=0;var G=new C(H,M,F.color,J,true);E.currentNode.points.push(G);delete E.moveNumbers[jsGameViewer.getId(H,M)]})}},processCurrentNode:function(){var F=this;var K=this.board;var G=this.currentNode;if(G.processed){for(var I=0;I<G.points.length;I++){var O=G.points[I];if(O.deleteFlag){K[O.x][O.y]=0}else{K[O.x][O.y]=O.color}this.moveNumbers[jsGameViewer.getId(O.x,O.y)]=O.moveNumber}if(G.blackPrisoners>0){this.blackPrisoners+=G.blackPrisoners;this.blackPrisonerPoints=this.blackPrisonerPoints.concat(G.blackPrisonerPoints)}if(G.whitePrisoners>0){this.whitePrisoners+=G.whitePrisoners;this.whitePrisonerPoints=this.whitePrisonerPoints.concat(G.whitePrisonerPoints)}return}G.processed=true;switch(G.type){case r:jq4gv.each(G.points,function(U,S){var R=S.x,W=S.y,T=S.color;if(R<0||R>=K.size||W<0||W>=K.size){return}switch(T){case e:S.color=K[R][W];S.deleteFlag=true;var V=[R,W,S.color,F.moveNumbers[jsGameViewer.getId(R,W)],G.moveNumber];if(S.color==z){G.blackPrisoners++;F.blackPrisoners++;G.blackPrisonerPoints.push(V);F.blackPrisonerPoints.push(V)}else{if(S.color==s){G.whitePrisoners++;F.whitePrisoners++;G.whitePrisonerPoints.push(V);F.whitePrisonerPoints.push(V)}}K[R][W]=0;break;case z:case s:K[R][W]=T;break}});break;case D:var N=G.x,L=G.y,H=G.color,Q=this.game.boardSize;if(N<0||N>=Q||L<0||L>=Q){throw"Invalid point: ("+N+","+L+")"}K[N][L]=H;var P=new l(G.moveNumber,G.depth);F.moveNumbers[jsGameViewer.getId(N,L)]=P;var O=new C(N,L,H,P);G.points.push(O);var J=(H==z)?s:z;if(F.game.type==jsGameViewer.DAOQI){var E=K.normalize(N-1);var M=L;if(K[E][M]==J){this.handleDeadGroup(K.getDeadGroup(E,M))}E=K.normalize(N+1);M=L;if(K[E][M]==J){this.handleDeadGroup(K.getDeadGroup(E,M))}E=N;M=K.normalize(L-1);if(K[E][M]==J){this.handleDeadGroup(K.getDeadGroup(E,M))}E=N;M=K.normalize(L+1);if(K[E][M]==J){this.handleDeadGroup(K.getDeadGroup(E,M))}}else{if(N>0){var E=N-1,M=L;if(K[E][M]==J){this.handleDeadGroup(K.getDeadGroup(E,M))}}if(N<K.size-1){var E=N+1,M=L;if(K[E][M]==J){this.handleDeadGroup(K.getDeadGroup(E,M))}}if(L>0){var E=N,M=L-1;if(K[E][M]==J){this.handleDeadGroup(K.getDeadGroup(E,M))}}if(L<K.size-1){var E=N,M=L+1;if(K[E][M]==J){this.handleDeadGroup(K.getDeadGroup(E,M))}}}this.handleDeadGroup(K.getDeadGroup(N,L));break;case m:break}if(!G.hasChildren()){if(!G.isOnBranch()&&this.last==null){F.last=new Object();F.last.node=G;F.last.board=jsGameViewer.clone(K);F.last.moveNumbers=jsGameViewer.clone(this.moveNumbers);F.last.blackPrisoners=this.blackPrisoners;F.last.blackPrisonerPoints=jsGameViewer.clone(this.blackPrisonerPoints);F.last.whitePrisoners=this.whitePrisoners;F.last.whitePrisonerPoints=jsGameViewer.clone(this.whitePrisonerPoints)}}},play:function(K,J){var H=this.board;if(K<0||K>=H.size||J<0||J>=H.size){return false}if(H[K][J]!=0){return false}var I=this.getNextPlayer();var F=(I==z)?s:z;H[K][J]=I;var G=0;if(K>0&&H[K-1][J]==F){var M=H.getDeadGroup(K-1,J);if(M!=null){G=M.length}}if(G<2&&K<H.size-1&&H[K+1][J]==F){var M=H.getDeadGroup(K+1,J);if(M!=null){G=+M.length}}if(G<2&&J>0&&H[K][J-1]==F){var M=H.getDeadGroup(K,J-1);if(M!=null){G=+M.length}}if(G<2&&J<H.size-1&&H[K][J+1]==F){var M=H.getDeadGroup(K,J+1);if(M!=null){G=+M.length}}var E=true;if(G==1){if(this.currentNode.type==D){if(H.isNeighbor(K,J,this.currentNode.x,this.currentNode.y)&&(this.currentNode.blackPrisoners==1||this.currentNode.whitePrisoners==1)){E=false}}}else{if(G==0){var M=H.getDeadGroup(K,J);if(M!=null&&M.length>0){E=false}}}if(!E){H[K][J]=0;return false}var L=new A(this.currentNode);L.temp=true;L.type=D;L.x=K;L.y=J;L.color=I;L.moveNumber=this.currentNode.moveNumber+1;if(this.currentNode.children.length==0){L.depth=this.currentNode.depth}else{L.depth=this.currentNode.depth+1}if(!L.isOnBranch()){this.last=null}this.currentNode.children.push(L);this.tempMoves.push([K,J]);return this.goToBranch(this.currentNode.children.length-1)},canRemove:function(){if(this.currentNode.temp){return true}else{return false}},remove:function(){if(this.canRemove()){var G=this.currentNode;var F=G.parent;var E=0;for(E=0;E<F.children.length;E++){if(F.children[E]==G){break}}this.back();F.children.splice(E,1);if(!G.isOnBranch()){this.last=null}}},back:function(){if(this.currentNode.isRoot()){return false}for(var F=0;F<this.currentNode.points.length;F++){var E=this.currentNode.points[F];if(E.deleteFlag){this.board[E.x][E.y]=E.color;this.moveNumbers[jsGameViewer.getId(E.x,E.y)]=E.moveNumber}else{this.board[E.x][E.y]=u;delete this.moveNumbers[jsGameViewer.getId(E.x,E.y)]}}if(this.currentNode.blackPrisoners>0){this.blackPrisoners-=this.currentNode.blackPrisoners;for(var F=0;F<this.currentNode.blackPrisoners;F++){if(this.blackPrisonerPoints.length>0){this.blackPrisonerPoints.pop()}}}if(this.currentNode.whitePrisoners>0){this.whitePrisoners-=this.currentNode.whitePrisoners;for(var F=0;F<this.currentNode.whitePrisoners;F++){if(this.whitePrisonerPoints.length>0){this.whitePrisonerPoints.pop()}}}this.currentNode=this.currentNode.parent;return true},backAll:function(){this.currentNode=this.rootNode;this.board.reset();this.moveNumbers=new Object();this.blackPrisoners=0;this.blackPrisonerPoints=[];this.whitePrisoners=0;this.whitePrisonerPoints=[];var E=this.board;jq4gv.each(this.currentNode.points,function(G,F){E[F.x][F.y]=F.color})},forward:function(){if(!this.currentNode.hasChildren()){return false}this.currentNode=this.currentNode.children[0];this.processCurrentNode();return true},forwardAll:function(){if(this.isOnBranch()||this.last==null){while(this.forward()){}}else{this.currentNode=this.last.node;this.board.copyFrom(this.last.board);this.moveNumbers=jsGameViewer.clone(this.last.moveNumbers);this.blackPrisoners=this.last.blackPrisoners;this.blackPrisonerPoints=jsGameViewer.clone(this.last.blackPrisonerPoints);this.whitePrisoners=this.last.whitePrisoners;this.whitePrisonerPoints=jsGameViewer.clone(this.last.whitePrisonerPoints)}},goToBranch:function(E){if(!this.currentNode.hasChildren()){return false}if(this.currentNode.children.length<=E){return false}this.currentNode=this.currentNode.children[E];this.processCurrentNode();return true}});var d=new Array();jq4gv.extend(d,{max:30,save:function(G){var I=G.game.getId();var E=null;for(var F=0;F<this.length;F++){if(this[F]==I){E=F;break}}if(E!=null&&E>0){for(var F=0;F<E-1;F++){this[F+1]=this[F]}}else{this.unshift(I);if(this.length>this.max){var H=this.pop();delete this[H]}}this[0]=I;this[I]=G}});return{STONE_NONE:u,STONE_BLACK:z,STONE_WHITE:s,STONE_ERASE:e,MODE_NORMAL:B,MODE_EDIT:q,MODE_SCORE:o,NODE_EMPTY:r,NODE_MOVE:D,NODE_PASS:m,MARK_NONE:y,MARK_SQUARE:t,MARK_CIRCLE:g,MARK_TRIANGLE:h,MARK_CROSS:x,MARK_TEXT:i,MARK_NUMBER:b,MARK_TERR_BLACK:v,MARK_TERR_WHITE:k,MARK_STONE:p,MoveNumber:l,Point:C,Board:w,Game:f,GameState:n,Node:A,GameHistory:d}}();jsGameViewer.SGFParser=jsGameViewer.createClass();jsGameViewer.SGFParser.prototype=function(){var I=jsGameViewer.WEIQI;var l=jsGameViewer.model.Game;var q=jsGameViewer.model.Node;var o=jsGameViewer.model.Point;var C=jsGameViewer.model.STONE_NONE;var y=jsGameViewer.model.STONE_BLACK;var G=jsGameViewer.model.STONE_WHITE;var H=jsGameViewer.model.NODE_MOVE;var x=jsGameViewer.model.NODE_PASS;var w=97;var b=0;var J=1;var i=2;var d=0;var k=1;var D=2;var M=3;var h=4;var z=5;var L=6;var K=7;var r=0;var v=1;var F=2;var B=3;var f=4;var A=5;var m=6;var t=7;var s="10";function e(O){this.gameType=O}function N(R,Q,O){var P;if(R!=-1){P=R}else{if(Q!=-1){P=Q}else{P=O}}if(R<P&&R!=-1){P=R}if(Q<P&&Q!=-1){P=Q}if(O<P&&O!=-1){P=O}return P}function u(O,P){while(true){c=O.charAt(P);if(c==" "||c=="\t"||c=="\n"||c=="\r"){P++}else{break}}return P}function p(O,R,Q){var P="SGFParser: ";if(R>0){P+=O.substring(0,R-1)}P+="{PARSING FAILED HERE: ";if(Q!=undefined&&Q!=null){P+=Q}P+="}";if(R<O.length){P+=O.substring(R)}return P}function E(Q,S){var R;var P=Q.length;var O="";R=Q.indexOf(S+"[");if(R==-1){return O}R+=2;if(Q.charAt(R)!="["){throw p(Q,R)}while(Q.charAt(++R)!="]"&&R<P){O+=Q.charAt(R)}if(R>P){throw p(Q,R)}return O}function g(P){var O=new l(this.gameType);Q=E(P,"GM");if(Q.length>0&&s==Q){O.type=DAOQI}var Q=E(P,"SZ");if(Q.length>0){try{O.boardSize=parseInt(Q)}catch(R){throw p(P,P.indexOf("SZ["))}}Q=E(P,"GN");if(Q.length>0){O.name=Q}Q=E(P,"CA");if(Q.length>0){O.charset=Q}Q=E(P,"PW");if(Q.length>0){O.whiteName=Q}Q=E(P,"WR");if(Q.length>0){O.whiteRank=Q}Q=E(P,"PB");if(Q.length>0){O.blackName=Q}Q=E(P,"BR");if(Q.length>0){O.blackRank=Q}Q=E(P,"RU");if(Q.length>0){O.rule=Q}Q=E(P,"KM");if(Q.length>0){try{O.komi=parseFloat(Q)}catch(R){throw p(P,P.indexOf("KM["))}}Q=E(P,"HA");if(Q.length>0){try{O.handicap=parseInt(Q)}catch(R){throw p(P,P.indexOf("HA["))}}Q=E(P,"RE");if(Q.length>0){O.result=Q}Q=E(P,"DT");if(Q.length>0){O.date=Q}Q=E(P,"PC");if(Q.length>0){O.place=Q}return O}function n(aa){var W=0;try{aa=aa.replace(/&/g,"&amp;");aa=aa.replace(/</g,"&lt;");var an=g(aa);var S=aa.length;var U=b;var W=0;var O=0;var ad=0;var V=0;var af=0;var ah=true;var al=0;var Y=-1;var X=-1;var ag=C;var ac=false;var P="";var ab=r;var am="";var T=an.rootNode;var ai=new Array();do{O=aa.indexOf("(",af);ad=aa.indexOf(")",af);V=aa.indexOf(";",af);W=N(O,ad,V);if(U==J&&W==ad){U=i}if(U==J&&W==O){U=b}else{if(U==b&&W==V){U=J}else{if(U==i&&W==O){U=b}}}switch(U){case b:if(W!=O){throw p(aa,W)}ai.push(T);af=W+1;break;case i:if(W!=ad){throw p(aa,W)}T=ai.pop();al=T.moveNumber;af=W+1;break;case J:if(W!=V){throw p(aa,W)}if(ah){ah=false}else{if(T.isDummyNode()&&T.parent!=null){T.parent.children.pop();T=T.parent}var Q=new q(T);Q.moveNumber=al;if(ai.length>0){Q.depth=ai[ai.length-1].depth+1}T.children.push(Q);T=Q}var R;W++;do{var Z=0;W=u(aa,W);if(aa.charAt(W)=="B"&&aa.charAt(Z=u(aa,W+1))=="["){R=d;W=Z;ag=y}else{if(aa.charAt(W)=="W"&&aa.charAt(Z=u(aa,W+1))=="["){R=k;W=Z;ag=G}else{if(aa.charAt(W)=="A"&&aa.charAt(W+1)=="B"&&aa.charAt(Z=u(aa,W+2))=="["){R=D;W=Z;ac=true;ag=y}else{if(aa.charAt(W)=="A"&&aa.charAt(W+1)=="W"&&aa.charAt(Z=u(aa,W+2))=="["){R=M;W=Z;ac=true;ag=G}else{if(aa.charAt(W)=="A"&&aa.charAt(W+1)=="E"&&aa.charAt(Z=u(aa,W+2))=="["){R=h;W=Z;ac=true;ag=STONE_ERASE}else{if(aa.charAt(W)=="T"&&aa.charAt(W+1)=="R"&&aa.charAt(Z=u(aa,W+2))=="["){R=L;ab=F;W=Z}else{if(aa.charAt(W)=="C"&&aa.charAt(W+1)=="R"&&aa.charAt(Z=u(aa,W+2))=="["){R=L;ab=f;W=Z}else{if(aa.charAt(W)=="S"&&aa.charAt(W+1)=="Q"&&aa.charAt(Z=u(aa,W+2))=="["){R=L;ab=B;W=Z}else{if(aa.charAt(W)=="M"&&aa.charAt(W+1)=="A"&&aa.charAt(Z=u(aa,W+2))=="["){R=L;ab=v;W=Z}else{if(aa.charAt(W)=="L"&&aa.charAt(W+1)=="B"&&aa.charAt(Z=u(aa,W+2))=="["){R=L;ab=A;W=Z;oldLabel=false}else{if(aa.charAt(W)=="C"&&aa.charAt(Z=u(aa,W+1))=="["){R=z;W=Z}else{if(aa.charAt(W)=="N"&&aa.charAt(Z=u(aa,W+1))=="["){R=K;W=Z}else{if(aa.charAt(W)=="T"&&aa.charAt(W+1)=="B"&&aa.charAt(Z=u(aa,W+2))=="["){R=L;ab=m;W=Z;ag=y}else{if(aa.charAt(W)=="T"&&aa.charAt(W+1)=="W"&&aa.charAt(Z=u(aa,W+2))=="["){R=L;ab=t;W=Z;ag=G}else{if(aa.charAt(W)==";"||aa.charAt(W)=="("||aa.charAt(W)==")"){W=u(aa,W);continue}else{var ak=aa.indexOf("]",W)+1;if(ak<=0){af=W+1;break}W=ak;W=u(aa,W);continue}}}}}}}}}}}}}}}do{if(aa.charAt(W)!="["){throw p(aa,W)}if(aa.charAt(W+1)=="]"){if(R==d||R==k){T.type=x;T.color=ag;T.moveNumber=++al}W+=2;continue}switch(R){case d:case k:Y=aa.charCodeAt(W+1)-w;X=aa.charCodeAt(W+2)-w;T.type=H;if(Y>=19||X>=19){T.type=x}T.color=ag;T.x=Y;T.y=X;T.moveNumber=++al;W+=4;break;case D:case M:case h:Y=aa.charCodeAt(W+1)-w;X=aa.charCodeAt(W+2)-w;T.points.push(new o(Y,X,ag));W+=4;break;case z:if(T.comment==null){T.comment=""}while(aa.charAt(++W)!="]"||(aa.charAt(W-1)=="\\"&&aa.charAt(W)=="]")){if(!(aa.charAt(W)=="\\"&&aa.charAt(W+1)=="]")&&!(aa.charAt(W)=="\\"&&aa.charAt(W+1)=="[")&&!(aa.charAt(W)=="\\"&&aa.charAt(W+1)==")")&&!(aa.charAt(W)=="\\"&&aa.charAt(W+1)=="(")){T.comment+=aa.charAt(W)}if(W>S){throw p(aa,S)}}W++;break;case K:T.name="";while(aa.charAt(++W)!="]"){T.name+=aa.charAt(W)}W++;break;case L:while(aa.charAt(W)=="["&&W<S){Y=aa.charCodeAt(W+1)-w;X=aa.charCodeAt(W+2)-w;W+=3;am="";if(ab==A){if(aa.charAt(W)!=":"){throw p(aa,W)}while(aa.charAt(++W)!="]"&&W<S){am+=aa.charAt(W)}try{var ae=parseInt(am);ab=A}catch(aj){ab=A}}if(T.marks==null){T.marks=new Array()}T.marks.push([Y,X,ab,am]);W++;W=u(aa,W)}break}W=u(aa,W)}while(ac&&aa.charAt(W)=="[");W=u(aa,W)}while(aa.charAt(W)!=";"&&aa.charAt(W)!="("&&aa.charAt(W)!=")"&&W<S);W=u(aa,W);af=W;break;default:throw p(aa,af)}}while(af<S&&W>=0);if(T.isDummyNode()&&T.parent!=null){T.parent.children.pop()}return an}catch(aj){throw p(aa,W,aj)}}return{initialize:e,parse:n}}();jsGameViewer.GameController=jsGameViewer.createClass();jq4gv.extend(jsGameViewer.GameController.prototype,{initialize:function(b){this.id=jsGameViewer.getGameId();this.jqId="#"+this.id;jsGameViewer[this.id]=this;this.config=jsGameViewer.clone(jsGameViewer.CONFIG);if(b!=null){jq4gv.extend(this.config,b)}this.reset()},init:function(){this.initView();this._initialized=true;return this},initialized:function(){return this._inialized==true},changeLocale:function(b){if(this.config.locale==b){return this}if(!jsGameViewer.LOCALES.indexOf(b)<0){alert("jsGameViewer WARNING: Invalid locale '"+b+"'");return this}this.config.locale=b;window.jsgvTranslations=window["jsgv_"+b];jsGameViewer.WEIQI_TEMPLATE=null;jsGameViewer.DAOQI_TEMPLATE=null;this.reset();this.show();if(this.gameState){this.gameState.backAll();this.initGame()}return this},destroy:function(){this.destroyView();delete jsGameViewer[this.id];jsGameViewer.length--},reset:function(){this._initialized=false;if(this.config.container!=null){var b=jq4gv("#"+this.config.container);if(b.get(0).nodeName=="DIV"){b.empty().append(this.getPlaceHolder())}else{if(jq4gv(this.jqId).get(0)){jq4gv(this.jqId).replaceWith(this.getPlaceHolder())}else{b.after(this.getPlaceHolder())}}}else{if(jq4gv(this.jqId).get(0)!=null){jq4gv(this.jqId).replaceWith(this.getPlaceHolder())}else{document.write(this.getPlaceHolder())}}return this},show:function(){if(!this.initialized()){this.init()}jq4gv(this.jqId).show();return this},hide:function(){jq4gv(this.jqId).hide();return this},setGameType:function(b){if(this.config.gameType!=b){this.config.gameType=b;this.reset()}return this},setGameTypeIf:function(b){if(this.config.gameType!=jsGameViewer.DAOQI&&this.game.type==jsGameViewer.DAOQI){this.setGameType(jsGameViewer.DAOQI)}return this},load:function(b,f){var d=jsGameViewer.model.GameHistory[b];if(d){jsGameViewer.model.GameHistory.save(d);this.game=d.game;this.setGameTypeIf(this.game.type).show();this.gameState=d;this.gameState.backAll();this.initGame();if(f==undefined){this.forwardAll()}else{this.forwardN(f)}return this}var e=this;jq4gv.ajax({url:b,success:function(g){if(e.game&&e.game.dataSize&&e.game.dataSize==g.length){return}e.game=new jsGameViewer.SGFParser(e.config.gameType).parse(g);e.game.dataSize=g.length;e.setGameTypeIf(e.game.type).show();e.game.url=b;e.gameState=new jsGameViewer.model.GameState(e.game);jsGameViewer.model.GameHistory.save(e.gameState);e.initGame();if(f==undefined){e.forwardAll()}else{e.forwardN(f)}},failure:function(){throw"GameController.load('"+b+"')->failure:"}});return this},loadSgf:function(b,f){try{b=jq4gv.trim(b);this.show();this.game=new jsGameViewer.SGFParser(this.config.gameType).parse(b);this.game.dataSize=b.length;this.setGameTypeIf(this.game.type);this.gameState=new jsGameViewer.model.GameState(this.game);this.initGame();if(f==undefined){this.forwardAll()}else{this.forwardN(f)}return this}catch(d){throw"GameController.loadSgf('"+b+"'): "+d}},loadInline:function(b,f){try{if(jq4gv("#"+b).length==0){return this}loadSgf(jq4gv("#"+b).text(),f);return this}catch(d){throw"GameController.loadInline('"+b+"'): "+d}},refresh:function(d){var b=this.game.url;var e=this;jq4gv.ajax({url:b,success:function(f){try{f=jq4gv.trim(f);jsgv.debug("refresh 1");if(!d&&e.game&&e.game.dataSize&&e.game.dataSize==f.length){return}jsgv.debug("refresh 2");e.game=new jsGameViewer.SGFParser(e.config.gameType).parse(f);e.game.dataSize=f.length;e.setGameTypeIf(e.game.type).show();e.game.url=b;e.gameState=new jsGameViewer.model.GameState(e.game);jsGameViewer.model.GameHistory.save(e.gameState);e.initGame();e.forwardAll()}catch(g){throw"GameController.refresh('"+b+"')->success: "+g}},failure:function(){throw"GameController.refresh('"+b+"')->failure:"}})},openInWindow:function(){var d=this.config.baseDir+"/php/game_window.php?";var g="jsgameviewer",e=722,b=452;if(this.config.gameType==jsGameViewer.DAOQI){d+="type=DAOQI&";e=798;b=528}if(this.game&&this.game.url){d+="url="+encodeURIComponent(this.game.url)}var f=window.open(d,g,"width="+e+"px,height="+b+"px,status=yes,location=no,resizable=yes")},getPlaceHolder:function(){return"<div id='"+this.id+"' style='display:none'>&nbsp;</div>"}});var GameController=jsGameViewer.GameController;jq4gv.extend(jsGameViewer.GameController.prototype,{setPlayerInterval:function(b){this.config.playerInterval=b;return this},setObserverInterval:function(b){this.config.observerInterval=b;return this},startUpdater:function(e){this.stopUpdater();if(this.game&&this.game.isFinished()){return this}var f=this;var d=function(){if(!f.game){return}if(f.game.isFinished()){f.stopUpdater();return}if(!e&&f.isMyTurn()){return}f.refresh()};var b=this.config.observerInterval;if(this.player){b=this.config.playerInterval}this.updater=setInterval(d,b*1000);return this},stopUpdater:function(){if(this.updater){clearInterval(this.updater);delete this.updater}return this}});jq4gv.extend(jsGameViewer.CONFIG,{gridSize:21,fastMode:10,showMoveNumber:false,activeBackground:"#EECD7A",inactiveBackground:"#CCAB69",boardColor:"#EECD7A",gridSizeWQ:21,gridSizeDQ:19,boardColorDQ:"#CCAB69",vbw:4,boardSizeDQ:27,rightPaneHeight:446,rightPaneHeightDQ:560});jq4gv.extend(jsGameViewer.GameController.prototype,function(){var d=["A","B","C","D","E","F","G","H","J","K","L","M","N","O","P","Q","R","S","T"];var b=["A","B","C","D","E","F","G","H","I","J"];return{destroyView:function(){jq4gv(this.jqId).remove()},getTemplateLocation:function(){var e=this.config.gameType==jsGameViewer.DAOQI?"daoqi":"weiqi";return this.config.viewDir+"templates/"+e+"_"+this.config.locale+".html"},initView:function(){if(this.initialized()){return this}this.config.x0=this.config.vbw;this.config.y0=this.config.vbw;var i="";if(this.config.gameType==jsGameViewer.DAOQI){this.config.gridSize=this.config.gridSizeDQ;if(jsGameViewer.DAOQI_TEMPLATE==null){jq4gv.ajax({async:false,dataType:"application/xml",url:this.getTemplateLocation(),success:function(l){jsGameViewer.DAOQI_TEMPLATE=l}})}i=jsGameViewer.DAOQI_TEMPLATE;this.rightPaneHeight=this.config.rightPaneHeightDQ}else{this.config.gridSize=this.config.gridSizeWQ;if(jsGameViewer.WEIQI_TEMPLATE==null){jq4gv.ajax({async:false,dataType:"application/xml",url:this.getTemplateLocation(),success:function(l){jsGameViewer.WEIQI_TEMPLATE=l}})}i=jsGameViewer.WEIQI_TEMPLATE;this.rightPaneHeight=this.config.rightPaneHeight}if(this.id!="GV1"){i=i.replace(/GV1/g,this.id)}jq4gv(this.jqId).replaceWith(i);var k=this;var g=function(m){k.registerKeyListener();var l=k.eventToXY(m);k.toX=l[0];k.toY=l[1];jq4gv(k.jqId+"_pointLabel").empty().append(k.xyToLabel(l[0],l[1]));return false};var h=function(l){jq4gv(k.jqId+"_pointLabel").empty();return false};var f=function(m){var l=k.eventToXY(m);if(k.config.gameType==jsGameViewer.DAOQI){k.fromX=k.toX=l[0];k.fromY=k.toY=l[1];jq4gv(this).css("cursor","move");jsgv.debug("fromX: "+k.fromX+", fromY: "+k.fromY)}else{k.play(l[0],l[1])}jq4gv(this).one("mouseup",e);return false};var e=function(l){jq4gv(this).unbind("mouseup");if(!(k.config.gameType==jsGameViewer.DAOQI)){return false}jq4gv(this).css("cursor","auto");if(k.fromX==undefined||k.fromX==NaN||k.fromY==undefined||k.fromY==NaN){return}if(k.fromX!=k.toX||k.fromY!=k.toY){k.moveBoard(k.toX-k.fromX,k.toY-k.fromY)}else{k.play(k.toX,k.toY)}return false};jq4gv(this.jqId+"_boardFascade").mousemove(g).mouseout(h).mousedown(f);this.setToggleNumberImg();this.addPrisonerHandlers();this.registerKeyListener();return this},addPrisonerHandlers:function(){var e=this;jq4gv(this.jqId+"_moveOuter, "+this.jqId+"_blackPrisonersOuter, "+this.jqId+"_whitePrisonersOuter").mouseout(function(){jq4gv(e.jqId+"_prisoners").empty()});jq4gv(this.jqId+"_blackPrisonersOuter").mouseover(function(){jq4gv(e.jqId+"_prisoners").empty();if(e.gameState.blackPrisoners>0){jq4gv.each(e.gameState.blackPrisonerPoints,function(f,g){e.showPrisoner(g)})}});jq4gv(this.jqId+"_whitePrisonersOuter").mouseover(function(){jq4gv(this.jqId+"_prisoners").empty();if(e.gameState.whitePrisoners>0){jq4gv.each(e.gameState.whitePrisonerPoints,function(f,g){e.showPrisoner(g)})}});jq4gv(this.jqId+"_moveOuter").mouseover(function(){jq4gv(e.jqId+"_prisoners").empty();if(e.gameState.currentNode.blackPrisoners>0){jq4gv.each(e.gameState.currentNode.blackPrisonerPoints,function(f,g){e.showPrisoner(g)})}if(e.gameState.currentNode.whitePrisoners>0){jq4gv.each(e.gameState.currentNode.whitePrisonerPoints,function(f,g){e.showPrisoner(g)})}})},showPrisoner:function(o){var i=this;var m=o[0],k=o[1],h=o[2];var f=this.xyToArea(m,k);var g=f[0],l=f[1],e=f[2],n=f[3];if(this.config.gameType==jsGameViewer.DAOQI){var q=h==jsGameViewer.model.STONE_BLACK?"gvsprite-19-black_dead":"gvsprite-19-white_dead";this.mapToPoints(m,k,function(t,w){var x=i.xyToArea(t,w);var z=x[0],y=x[1],v=x[2],r=x[3];var u="<div class='"+q+"' style='position:absolute;left:"+z+"px;top:"+y+"px;";if(i.gameState.board[m][k]==jsGameViewer.model.STONE_NONE){if(i.isInCentralArea(t,w)){u+="background-color:"+i.config.boardColorDQ+";"}else{u+="background-color:"+i.config.boardColor+";"}}u+="'></div>";jq4gv(this.jqId+"_prisoners").append(u)})}else{var q=h==jsGameViewer.model.STONE_BLACK?"gvsprite-21-black_dead":"gvsprite-21-white_dead";var p="<div class='"+q+"' style='position:absolute;left:"+g+"px;top:"+l+"px;";if(this.gameState.board[m][k]==jsGameViewer.model.STONE_NONE){p+="background-color:"+this.config.boardColor+";"}p+="'></div>";jq4gv(this.jqId+"_prisoners").append(p)}},removeKeyListener:function(){jq4gv(this.jqId+"_bannerbg").css("background-color",this.config.inactiveBackground)},registerKeyListener:function(){var f=this;for(var e=1;e<=jsGameViewer.length;e++){jsGameViewer[jsGameViewer.getGameId(e)].removeKeyListener()}jq4gv(this.jqId+"_bannerbg").css("background-color",this.config.activeBackground);document.onkeydown=function(h){var g;if(window.event){g=window.event.keyCode}else{if(h){g=h.which}else{return}}h=h||window.event;switch(g){case 37:if(h.ctrlKey){if(h.altKey){f.backAll()}else{f.backN(f.config.fastMode)}}else{if(h.altKey&&h.shiftKey){f.backToComment()}else{f.back()}}return;case 39:if(h.ctrlKey){if(h.altKey){f.forwardAll()}else{f.forwardN(f.config.fastMode)}}else{if(h.altKey&&h.shiftKey){f.forwardToComment()}else{f.forward()}}return;case 46:f.remove();return}if(h.altKey&&h.shiftKey){switch(g){case 71:f.goTo();break;case 77:f.toggleNumber();break;case 82:f.refresh();break;default:if(g>=65&&g<=90){f.goToBranch(g-65)}}}};return this},initGame:function(){return this.removeAllStones().setGameInfo().setGameState().addRemoveStones(this.gameState.currentNode.points)},setGameInfo:function(){if(this.isMyTurn()&&!this.game.isFinished()){jq4gv(this.jqId+"_resign").show()}else{jq4gv(this.jqId+"_resign").hide()}var k=jq4gv(this.jqId+"_info").empty();var g=this.game;if(g==undefined||g==null){return this}if(jsGameViewer.notNull(g.name)){k.append("<div align='center' style='font-weight:bold'>"+jq4gv.trim(g.name)+"</div>")}if(jsGameViewer.notNull(g.date)){k.append("<div>"+jsgvTranslations.time+": "+jq4gv.trim(g.date)+"</div>")}if(jsGameViewer.notNull(g.place)){k.append("<div>"+jsgvTranslations.place+": "+jq4gv.trim(g.place)+"</div>")}var l="&nbsp;&#8592; "+jsgvTranslations.play_first;var f="";if(jsGameViewer.notNull(g.blackRank)){f="&nbsp;("+g.blackRank+")"}var e="<div>"+jsgvTranslations.black+": <strong>"+jq4gv.trim(g.blackName)+"</strong>"+f;if(g.getFirstPlayer()==jsGameViewer.model.STONE_BLACK){e+=l}e+="</div>";k.append(e);var i="";if(jsGameViewer.notNull(g.whiteRank)){i="&nbsp;("+g.whiteRank+")"}var h="<div>"+jsgvTranslations.white+": <strong>"+jq4gv.trim(g.whiteName)+"</strong>"+i;if(g.getFirstPlayer()==jsGameViewer.model.STONE_WHITE){h+=l}h+="</div>";k.append(h);if(g.handicap>0){k.append("<div>"+jsgvTranslations.handicap+": "+g.handicap+"</div>")}else{k.append("<div>"+jsgvTranslations.rule+": "+jq4gv.trim(g.rule)+"</div>");k.append("<div>"+jsgvTranslations.komi+": "+g.komi+"</div>")}k.append("<div>"+jsgvTranslations.moves+": "+g.getMoves()+"</div>");k.append("<div>"+jsgvTranslations.result+": "+jq4gv.trim(g.result)+"</div>");return this},removeGameInfo:function(){jq4gv(this.jqId+"_info").empty();return this},setGameState:function(){var e=this.gameState.currentNode;this.setNextPlayer(this.gameState.getNextPlayer());this.setMoveNumber(e.moveNumber);this.setPrisoners(this.gameState.blackPrisoners,this.gameState.whitePrisoners);if(e.type==jsGameViewer.model.NODE_MOVE){this.setMoveMark(e.x,e.y)}else{this.removeMoveMark()}this.setMarks(e.marks);this.setBranches();this.setComment();return this},moveBoard:function(p,n){var l=this;if(this.config.gameType!=jsGameViewer.DAOQI){return}var m=this.gameState.board;this.config.x0=m.normalize(this.config.x0+p);this.config.y0=m.normalize(this.config.y0+n);this.removeAllStones();this.removeBranches();this.removeMoveMark();var r="";for(var k=0;k<m.size;k++){for(var g=0;g<m.size;g++){var f=m[k][g];if(f==jsGameViewer.model.STONE_BLACK||f==jsGameViewer.model.STONE_WHITE){var q=0;if(this.config.showMoveNumber){q=this.gameState.getMoveNumber(k,g)}this.mapToPoints(k,g,function(i,s){r+=l.createStone(i,s,f,q)})}}}if(r.length>0){jq4gv(this.jqId+"_boardPoints").append(r)}this.setBranches();var e=this.gameState.currentNode;if(e.type==jsGameViewer.model.NODE_MOVE){this.setMoveMark(e.x,e.y)}else{this.removeMoveMark()}var o=(this.config.y0-this.config.vbw)*this.config.gridSize;jq4gv(this.jqId+"_vlabel").css("backgroundPosition","0px "+o+"px");var h=(this.config.x0-this.config.vbw)*this.config.gridSize;jq4gv(this.jqId+"_hlabel").css("backgroundPosition",h+"px 0px");this.setMarks(e.marks);return this},mapToPoints_:function(m,k){var o=new Array();var e=m+this.config.x0,l=k+this.config.y0;var f=[];if(e>=0&&e<this.config.boardSizeDQ){f.push(e)}if(e>=this.config.boardSize){f.push(e-this.config.boardSize)}if(e<this.config.boardSizeDQ-this.config.boardSize){f.push(e+this.config.boardSize)}var n=[];if(l>=0&&l<this.config.boardSizeDQ){n.push(l)}if(l>=this.config.boardSize){n.push(l-this.config.boardSize)}if(l<this.config.boardSizeDQ-this.config.boardSize){n.push(l+this.config.boardSize)}for(var h=0;h<f.length;h++){for(var g=0;g<n.length;g++){o.push([f[h],n[g]])}}return o},mapToPoints:function(e,l,k){var h=this.mapToPoints_(e,l);for(var f=0;f<h.length;f++){var g=h[f];k(g[0],g[1])}return this},getStoneId:function(e,f){return this.id+"_point_"+e+"-"+f},createStone:function(k,i,f,m){var h="";if(this.config.gameType==jsGameViewer.DAOQI){if(f==jsGameViewer.model.STONE_BLACK){h="gvsprite-19-black"}else{if(f==jsGameViewer.model.STONE_WHITE){h="gvsprite-19-white"}else{return null}}}else{if(f==jsGameViewer.model.STONE_BLACK){h="gvsprite-21-black"}else{if(f==jsGameViewer.model.STONE_WHITE){h="gvsprite-21-white"}else{return null}}}var n="<div id='"+this.getStoneId(k,i)+"' class='"+h+"' style='position:absolute;left:";a=this.xyToArea(k,i);n+=a[0]+"px;top:"+a[1]+"px;'>";if(this.config.showMoveNumber&&m>0){var g="white";if(f==jsGameViewer.model.STONE_WHITE){g="black"}var l="medium";var e=0;if(m>=10&&m<100){l="small"}else{if(m>=100){l="x-small";e=1}}n+="<div style='display:table;width:"+a[2]+"px;height:"+a[3]+"px;#position:relative;overflow:hidden;'><div style='display:table-cell;vertical-align:middle;#position:absolute;#top:50%;'><div style='#position:relative;left:"+e+"px;width:100%;#top:-50%;text-align:center;color:"+g+";font-family:times;font-size:"+l+";'>"+m+"</div></div></div>"}else{n+="&nbsp;"}n+="</div>";return n},addStone:function(e,k,f){var i=this;var h=0;if(this.config.showMoveNumber){h=this.gameState.getMoveNumber(e,k)}if(this.config.gameType==jsGameViewer.DAOQI){this.mapToPoints(e,k,function(l,n){var m=i.createStone(l,n,f,h);if(m!=null){jq4gv(i.jqId+"_boardPoints").append(m)}})}else{var g=this.createStone(e,k,f,h);if(g!=null){jq4gv(this.jqId+"_boardPoints").append(g)}}return this},addRemoveStones:function(g){for(var f=0;f<g.length;f++){var e=g[f];this.removeStone(e.x,e.y);if(!e.deleteFlag){this.addStone(e.x,e.y,e.color)}}return this},removeStone:function(e,h){var g=this;if(this.config.gameType==jsGameViewer.DAOQI){this.mapToPoints(e,h,function(i,l){var k=jq4gv("#"+g.getStoneId(i,l));k.remove()})}else{var f=jq4gv("#"+this.getStoneId(e,h));f.remove()}return this},removeAllStones:function(){jq4gv(this.jqId+"_boardPoints").children().remove();return this},setNextPlayer:function(e){var f="";if(e==jsGameViewer.model.STONE_WHITE){f=this.config.viewDir+"/images/15/white.png"}else{f=this.config.viewDir+"/images/15/black.png"}jq4gv(this.jqId+"_nextPlayer").attr("src",f);return this},setMoveNumber:function(e){if(e==0){e="0"}jq4gv(this.jqId+"_curMove").empty().append(e);return this},setMoveMark:function(e,g){var f=this;if(this.config.gameType==jsGameViewer.DAOQI){jq4gv(this.jqId+"_moveMarks").empty();this.mapToPoints(e,g,function(h,k){var i=f.xyToArea(h,k);jq4gv(f.jqId+"_moveMarks").append("<div class='gvsprite-19-markmove' style='position:absolute;left:"+i[0]+"px;top:"+i[1]+"px;width:"+i[2]+"px;height:"+i[3]+"px'>&nbsp;</div>")})}else{jq4gv(this.jqId+"_moveMark").css({position:"absolute",left:e*this.config.gridSize,top:g*this.config.gridSize,width:this.config.gridSize,height:this.config.gridSize})}return this},removeMoveMark:function(){if(this.config.gameType==jsGameViewer.DAOQI){jq4gv(this.jqId+"_moveMarks").empty()}else{jq4gv(this.jqId+"_moveMark").css({width:0,height:0})}return this},setMarks:function(q){var n=this;jq4gv(this.jqId+"_boardMarks").empty();if(q==undefined||q==null){return this}if(this.config.gameType==jsGameViewer.DAOQI){for(var l=0;l<q.length;l++){var h=q[l];var r=h[0],p=h[1];var k=this.gameState.board[r][p];var m="";switch(h[2]){case jsGameViewer.model.MARK_CROSS:m="gvsprite-19-markcross";break;case jsGameViewer.model.MARK_TRIANGLE:m="gvsprite-19-marktriangle";break;case jsGameViewer.model.MARK_SQUARE:m="gvsprite-19-marksquare";break;case jsGameViewer.model.MARK_CIRCLE:m="gvsprite-19-markcircle";break;case jsGameViewer.model.MARK_TERR_BLACK:m="gvsprite-19-markblack";break;case jsGameViewer.model.MARK_TERR_WHITE:m="gvsprite-19-markwhite";break;case jsGameViewer.model.MARK_TEXT:this.mapToPoints(r,p,function(v,D){var A=n.xyToArea(v,D);var C=A[0],B=A[1],z=A[2],i=A[3];var w="<div style='position:absolute;left:"+C+"px;top:"+B+"px;width:"+z+"px;height:"+i+"px;text-align:center;vertical-align:middle;color:red;font-family:Nina;font-weight:bolder;font-size:14px;";if(k==jsGameViewer.model.STONE_NONE){if(n.isInCentralArea(v,D)){w+="background-color:"+n.config.boardColorDQ+";"}else{w+="background-color:"+n.config.boardColor+";"}}w+="'>"+h[3]+"</div>";jq4gv(n.jqId+"_boardMarks").append(w)});continue}this.mapToPoints(r,p,function(v,D){var A=n.xyToArea(v,D);var C=A[0],B=A[1],z=A[2],i=A[3];var w="<div class='"+m+"' style='position:absolute;left:"+C+"px;top:"+B+"px;";if(k==jsGameViewer.model.STONE_NONE){if(n.isInCentralArea(v,D)){w+="background-color:"+n.config.boardColorDQ+";"}else{w+="background-color:"+n.config.boardColor+";"}}w+="'></div>";jq4gv(n.jqId+"_boardMarks").append(w)})}}else{for(var l=0;l<q.length;l++){var h=q[l];var r=h[0],p=h[1];var k=this.gameState.board[r][p];var f=this.xyToArea(r,p);var g=f[0],o=f[1],e=f[2],t=f[3];var m="";switch(h[2]){case jsGameViewer.model.MARK_CROSS:m="gvsprite-21-markcross";break;case jsGameViewer.model.MARK_TRIANGLE:m="gvsprite-21-marktriangle";break;case jsGameViewer.model.MARK_SQUARE:m="gvsprite-21-marksquare";break;case jsGameViewer.model.MARK_CIRCLE:m="gvsprite-21-markcircle";break;case jsGameViewer.model.MARK_TERR_BLACK:m="gvsprite-21-markblack";break;case jsGameViewer.model.MARK_TERR_WHITE:m="gvsprite-21-markwhite";break;case jsGameViewer.model.MARK_TEXT:var u="<div style='position:absolute;left:"+g+"px;top:"+o+"px;width:"+e+"px;height:"+t+"px;text-align:center;vertical-align:middle;color:red;font-family:Nina;font-weight:bolder;font-size:15px;";if(k==jsGameViewer.model.STONE_NONE){u+="background-color:"+this.config.boardColor+";"}u+="'>"+h[3]+"</div>";jq4gv(this.jqId+"_boardMarks").append(u);continue}var u="<div class='"+m+"' style='position:absolute;left:"+g+"px;top:"+o+"px;";if(k==jsGameViewer.model.STONE_NONE){u+="background-color:"+this.config.boardColor+";"}u+="'></div>";jq4gv(this.jqId+"_boardMarks").append(u)}}return this},setPrisoners:function(e,f){if(e==0){e="0"}if(f==0){f="0"}jq4gv(this.jqId+"_blackPrisoners").empty().append(e);jq4gv(this.jqId+"_whitePrisoners").empty().append(f);return this},setBranches:function(){var l=this;jq4gv(this.jqId+"_boardBranches").empty();jq4gv(this.jqId+"_branches").empty();jq4gv(this.jqId+"_branches").css({height:0});var h=this.gameState.currentNode;if(h.hasChildren()&&h.children.length>=2){var g=h.children.length;for(var k=0;k<h.children.length;k++){var q="";if(k==0){q=jsgvTranslations.branch+" A = "+jsgvTranslations.trunk+" [Alt Shift &#8594;][Alt Shift A]"}else{if(k<b.length){var m=b[k];q=jsgvTranslations.branch+" "+m+" [Alt Shift "+m+"]"}}var r="<div class='gvtb-branch gvbutton'><a href='#' title='"+q+"' onclick='jsGameViewer."+this.id+".goToBranch("+k+");return false;'>"+b[k]+"</a></div>";jq4gv(this.jqId+"_branches").append(r);jq4gv(this.jqId+"_branches").css({height:g*23});var f=h.children[k];if(f.type==jsGameViewer.model.NODE_MOVE){var p=f.x,o=f.y;if(this.config.gameType==jsGameViewer.DAOQI){this.mapToPoints(p,o,function(i,t){var n="gvbranch";if(l.isInCentralArea(i,t)){n="gvbranch-real"}var s=l.xyToArea(i,t);jq4gv(l.jqId+"_boardBranches").append("<div class='"+n+"' style='left:"+s[0]+"px;top:"+s[1]+"px;width:"+s[2]+"px;height:"+s[3]+"px;'>"+b[k]+"</div>")})}else{var e=l.xyToArea(p,o);jq4gv(l.jqId+"_boardBranches").append("<div class='gvbranch' style='left:"+e[0]+"px;top:"+e[1]+"px;width:"+e[2]+"px;height:"+e[3]+"px;'>"+b[k]+"</div>")}}}}return this},removeBranches:function(){jq4gv(this.jqId+"_boardBranches").empty();jq4gv(this.jqId+"_branches").empty();jq4gv(this.jqId+"_branches").css({height:0});return this},setComment:function(f){var e=this.gameState.currentNode;if(!f){f="<strong>";f+=jsgvTranslations.comment_for.replace(/MOVE/,e.moveNumber)+":</strong>";if(e.comment!=undefined&&e.comment!=null){f+="<br/>"+e.comment.replace(/\n/g,"<br/>\n")}}jq4gv(this.jqId+"_comment").empty().append(f);jq4gv(this.jqId+"_comment").height(this.rightPaneHeight-jq4gv(this.jqId+"_info").height()-12);return this},removeComment:function(){jq4gv(this.jqId+"_comment").empty();return this},redrawBoard:function(){var m=this;var k=this.gameState.board;var h="";if(this.config.gameType==jsGameViewer.DAOQI){for(var g=0;g<k.size;g++){for(var f=0;f<k.size;f++){var e=k[g][f];var l=0;if(this.config.showMoveNumber){l=this.gameState.getMoveNumber(g,f)}if(e==jsGameViewer.model.STONE_BLACK||e==jsGameViewer.model.STONE_WHITE){this.mapToPoints(g,f,function(i,n){h+=m.createStone(i,n,e,l)})}}}}else{for(var g=0;g<k.size;g++){for(var f=0;f<k.size;f++){var e=k[g][f];var l=0;if(this.config.showMoveNumber){l=this.gameState.getMoveNumber(g,f)}if(e==jsGameViewer.model.STONE_BLACK||e==jsGameViewer.model.STONE_WHITE){h+=this.createStone(g,f,e,l)}}}}jq4gv(this.jqId+"_boardPoints").empty();if(h.length>0){jq4gv(this.jqId+"_boardPoints").append(h)}return this},play:function(e,n){if(this.gameState==null){return this}var m=this;if(this.gameState.board[e][n]!=0){if(this.gameState.isFirst()){return false}var h=new Array();var l=false;for(;;){var k=this.gameState.currentNode;if(k.type==jsGameViewer.model.NODE_MOVE&&k.x==e&&k.y==n){break}if(!this.back_(h)){break}l=true}if(l){jq4gv.each(h,function(p,o){m.removeStone(o.x,o.y);if(o.deleteFlag){m.addStone(o.x,o.y,o.color)}});this.setGameState();return true}return false}if(!this.gameState.isLast()){var g=this.gameState.currentNode.children;for(var f=0;f<g.length;f++){var k=g[f];if(k.type==jsGameViewer.model.NODE_MOVE&&k.x==e&&k.y==n){return this.goToBranch(f)}}}if(this.gameState.play(e,n)){var k=this.gameState.currentNode;jq4gv.each(k.points,function(p,o){m.removeStone(o.x,o.y);if(!o.deleteFlag){m.addStone(o.x,o.y,o.color)}});this.setGameState();return true}else{return false}},remove:function(){var f=this;if(this.gameState!=null&&this.gameState.canRemove()){var e=this.gameState.currentNode;jq4gv.each(e.points,function(h,g){f.removeStone(g.x,g.y);if(g.deleteFlag){f.addStone(g.x,g.y,g.color)}});this.gameState.remove();this.setGameState()}return this},back_:function(h){if(this.gameState.isFirst()){return false}var k=this.gameState.currentNode;for(var g=0;g<k.points.length;g++){var e=k.points[g];var l=false;for(var f=0;f<h.length;f++){var m=h[f];if(e.x==m.x&&e.y==m.y){l=true;h[f]=e;break}}if(!l){h.push(e)}}this.gameState.back();return true},back:function(){if(this.gameState==null){return this}if(this.gameState.isFirst()){return false}var f=this;var e=this.gameState.currentNode;jq4gv.each(e.points,function(h,g){f.removeStone(g.x,g.y);if(g.deleteFlag){f.addStone(g.x,g.y,g.color)}});this.gameState.back();this.setGameState();return true},backN:function(k){if(this.gameState==null){return this}var h=this;if(k==undefined){k=this.config.fastMode}var f=new Array();var g=false;for(var e=0;e<k;e++){if(!this.back_(f)){break}g=true}if(g){jq4gv.each(f,function(m,l){h.removeStone(l.x,l.y);if(l.deleteFlag){h.addStone(l.x,l.y,l.color)}});this.setGameState()}return this},backToComment:function(){if(this.gameState==null){return this}var h=this;var e=new Array();var g=false;for(;;){if(!this.back_(e)){break}g=true;var f=this.gameState.currentNode;if(f.hasComment()||f.hasBranches()){break}}if(g){jq4gv.each(e,function(l,k){h.removeStone(k.x,k.y);if(k.deleteFlag){h.addStone(k.x,k.y,k.color)}});this.setGameState()}return this},backAll:function(){if(this.gameState==null){return this}var f=this;this.removeAllStones();this.gameState.backAll();var e=this.gameState.currentNode;jq4gv.each(e.points,function(h,g){if(g.color==jsGameViewer.model.STONE_BLACK||g.color==jsGameViewer.model.STONE_WHITE){f.addStone(g.x,g.y,g.color)}});this.setGameState();return this},forward_:function(h){if(this.gameState.isLast()){return false}this.gameState.forward();var k=this.gameState.currentNode;for(var g=0;g<k.points.length;g++){var e=k.points[g];var l=false;for(var f=0;f<h.length;f++){var m=h[f];if(e.x==m.x&&e.y==m.y){l=true;h[f]=e;break}}if(!l){h.push(e)}}return true},forward:function(){if(this.gameState==null){return this}if(!this.gameState.forward()){return false}var f=this;var e=this.gameState.currentNode;jq4gv.each(e.points,function(h,g){f.removeStone(g.x,g.y);if(!g.deleteFlag){f.addStone(g.x,g.y,g.color)}});this.setGameState();return true},forwardN:function(k){if(this.gameState==null){return this}var h=this;if(k==undefined){k=this.config.fastMode}var f=new Array();var g=false;for(var e=0;e<k;e++){if(!this.forward_(f)){break}g=true}if(g){jq4gv.each(f,function(m,l){h.removeStone(l.x,l.y);if(!l.deleteFlag){h.addStone(l.x,l.y,l.color)}});this.setGameState()}return this},forwardToComment:function(){if(this.gameState==null){return this}var h=this;var e=new Array();var g=false;for(;;){if(!this.forward_(e)){break}g=true;var f=this.gameState.currentNode;if(f.hasComment()||f.hasBranches()){break}}if(g){jq4gv.each(e,function(l,k){h.removeStone(k.x,k.y);if(!k.deleteFlag){h.addStone(k.x,k.y,k.color)}});this.setGameState()}return this},forwardAll:function(){if(this.gameState==null){return this}this.removeAllStones();this.gameState.forwardAll();this.redrawBoard();this.setGameState();return this},goToBranch:function(g){if(this.gameState==null){return this}if(!this.gameState.goToBranch(g)){return this}var f=this;var e=this.gameState.currentNode;jq4gv.each(e.points,function(k,h){f.removeStone(h.x,h.y);if(!h.deleteFlag){f.addStone(h.x,h.y,h.color)}});this.setGameState();return this},goTo:function(i){if(this.gameState==null){return this}var f=prompt("Please enter the move number: ");var i=parseInt(f);if(isNaN(i)||i<0){alert("Not a valid move number.");return}var h=this;while(this.gameState.isOnBranch()){this.back()}if(i>=this.gameState.game.getMoves()){this.forwardAll()}else{if(i<=0){this.backAll()}else{if(i>this.gameState.currentNode.moveNumber){var e=new Array();var g=false;while(i>this.gameState.currentNode.moveNumber){if(!this.forward_(e)){break}g=true}if(g){jq4gv.each(e,function(l,k){h.removeStone(k.x,k.y);if(!k.deleteFlag){h.addStone(k.x,k.y,k.color)}});this.setGameState()}}else{if(i<this.gameState.currentNode.moveNumber){var e=new Array();var g=false;while(i<this.gameState.currentNode.moveNumber){if(!this.back_(e)){break}g=true}if(g){jq4gv.each(e,function(l,k){h.removeStone(k.x,k.y);if(k.deleteFlag){h.addStone(k.x,k.y,k.color)}});this.setGameState()}}}}}return this},goToXYs:function(f){this.backAll();for(var g=0;g<f.length;g++){var e=f[g][0],k=f[g][1];var h=this.gameState.currentNode.childThatMatches(e,k);if(h!=null){this.goToBranch(h)}else{break}}return this},setToggleNumberImg:function(){if(this.config.showMoveNumber){jq4gv(this.jqId+"_toggleNumberImg").removeClass("gvsprite-hidenumber");jq4gv(this.jqId+"_toggleNumberImg").addClass("gvsprite-shownumber")}else{jq4gv(this.jqId+"_toggleNumberImg").removeClass("gvsprite-shownumber");jq4gv(this.jqId+"_toggleNumberImg").addClass("gvsprite-hidenumber")}return this},toggleNumber:function(){if(this.config.showMoveNumber){this.config.showMoveNumber=false}else{this.config.showMoveNumber=true}this.setToggleNumberImg();if(this.gameState==null){return this}this.redrawBoard();return this},showNumber:function(){if(this.config.hideMoveNumber){this.toggleNumber()}return this},hideNumber:function(){if(this.config.showMoveNumber){this.toggleNumber()}return this},eventToXY:function(g){g=g.originalEvent||window.event;layerX=g.layerX||g.offsetX||g.clientX;layerY=g.layerY||g.offsetY||g.clientY;var f=parseInt(layerX/this.config.gridSize);var h=parseInt(layerY/this.config.gridSize);if(this.config.gameType==jsGameViewer.DAOQI){f=(f+this.config.boardSize-this.config.x0)%this.config.boardSize;h=(h+this.config.boardSize-this.config.y0)%this.config.boardSize}return[f,h]},isInCentralArea:function(e,f){return e>=this.config.vbw&&e<this.config.boardSize+this.config.vbw&&f>=this.config.vbw&&f<this.config.boardSize+this.config.vbw},xyToArea:function(e,f){return[e*this.config.gridSize,f*this.config.gridSize,this.config.gridSize,this.config.gridSize]},xyToLabel:function(e,g){var f=d[e];f+=this.config.boardSize-parseInt(g);return f}}}());jq4gv.extend(jsGameViewer.GameController.prototype,{setPlayer:function(b){this.player=b;return this},saveSession:function(d,b){if(!this.sessionSaver){this.sessionSaver=setInterval(function(){jq4gv.ajax({url:d})},b*1000)}return this},setUsernameElemId:function(b){this.usernameElemId=b;return this},setUsername:function(b){this.username=b;return this},getUsername:function(){if(this.username){return this.username}else{if(this.usernameElemId){return jq4gv.trim(jq4gv("#"+this.usernameElemId).text())}else{return null}}},isPlayer:function(){if(this.player&&this.player.isPlayer){return this.player.isPlayer()}else{return false}},isMyTurn:function(){if(this.player&&this.player.isMyTurn){return this.player.isMyTurn()}else{return false}},sendMove:function(){if(this.player&&this.player.sendMove){return this.player.sendMove()}else{return false}},resign:function(){if(this.player&&this.player.resign){if(confirm(jsgvTranslations.confirm_resign)){this.player.resign()}}else{return false}},origPlay:jsGameViewer.GameController.prototype.play,play:function(b,d){if(this.origPlay(b,d)&&this.player&&this.player.sendMove){return this.player.sendMove()}}});